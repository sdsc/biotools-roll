<!-- http://miso.readthedocs.org/en/fastmiso -->

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MISO (Mixture of Isoforms) software documentation &mdash; MISO  documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  

  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  
    <link rel="top" title="MISO  documentation" href="#"/>
        <link rel="next" title="MISO (Mixture of Isoforms) software documentation" href=""/>
 
<!-- RTD Extra Head -->



<!-- 
Read the Docs is acting as the canonical URL for your project. 
If you want to change it, more info is available in our docs:
  http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://miso.readthedocs.org/en/latest/" />

<script type="text/javascript">
  // This is included here because other places don't have access to the pagename variable.
  var READTHEDOCS_DATA = {
    project: "miso",
    version: "fastmiso",
    language: "en",
    page: "index",
    builder: "sphinx",
    theme: "sphinx_rtd_theme",
    docroot: "/docs/source/",
    source_suffix: ".rst",
    api_host: "https://readthedocs.org",
    commit: "132ba0e680689a4388bb51b9c546cde02bc570b0"
  }
  // Old variables
  var doc_version = "fastmiso";
  var doc_slug = "miso";
  var page_name = "index";
  var html_theme = "sphinx_rtd_theme";
</script>
<!-- RTD Analytics Code -->
<!-- Included in the header because you don't have a footer block. -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  // User Analytics Code
  _gaq.push(['user._setAccount', 'UA-19654897-1']);
  _gaq.push(['user._trackPageview']);
  // End User Analytics Code


  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- end RTD Analytics Code -->
<!-- end RTD <extrahead> -->


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="#" class="fa fa-home"> MISO</a>
        
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">MISO (Mixture of Isoforms) software documentation</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#what-is-miso">What is MISO?</a></li>
<li class="toctree-l1"><a class="reference internal" href="#how-miso-works">How MISO works</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#features">Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#mailing-list">Mailing list</a></li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#releases">Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#latest-version-from-github">Latest version from GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-requirements">Installation requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-fastmiso-version-of-miso">Installing the <tt class="docutils literal"><span class="pre">fastmiso</span></tt> version of MISO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-the-installation">Testing the installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-miso">Testing MISO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="#ways-of-running-miso-and-associated-file-formats">Ways of running MISO and associated file formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="#using-miso-in-parallel-on-multiple-cores">Using MISO in parallel on multiple cores</a></li>
<li class="toctree-l1"><a class="reference internal" href="#using-miso-on-a-cluster">Using MISO on a cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="#alternative-event-annotations">Alternative event annotations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expanded-alternative-cleavage-and-polyadenylation-annotation-for-mouse">Expanded alternative cleavage and polyadenylation annotation for mouse</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gff-based-alternative-events-format">GFF-based alternative events format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mapping-of-alternative-events-to-genes">Mapping of alternative events to genes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-gff-event-annotations-with-paired-end-reads">Using GFF event annotations with paired-end reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="#human-mouse-gene-models-for-isoform-centric-analyses">Human/mouse gene models for isoform-centric analyses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#running-miso">Running MISO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#invoking-miso-from-the-command-line">Invoking MISO from the command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-the-rna-seq-reads">Preparing the RNA-Seq reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-the-alternative-isoforms-annotation">Preparing the alternative isoforms annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-miso">Configuring MISO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-expression-estimates-psi-psi-values">Computing expression estimates (&#8220;Psi&#8221; / Ψ values)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#summarizing-miso-output">Summarizing MISO output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#summary-file-output-format">Summary file output format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#detecting-differentially-expressed-isoforms">Detecting differentially expressed isoforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#output-of-samples-comparison">Output of samples comparison</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#compressing-raw-miso-output">Compressing raw MISO output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#packing-miso-output">Packing MISO output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#long-term-archival-and-compression-of-miso-output">Long-term archival and compression of MISO output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#example-miso-pipeline">Example MISO pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="#interpreting-and-filtering-miso-output">Interpreting and filtering MISO output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-the-read-class-counts">Using the read class counts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-confidence-intervals">Using the confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering-differentially-expressed-events">Filtering differentially expressed events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#visualizing-and-plotting-miso-output">Visualizing and plotting MISO output</a></li>
<li class="toctree-l1"><a class="reference internal" href="#updates">Updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="#frequently-asked-questions-faq">Frequently Asked Questions (FAQ)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#answers">Answers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#advanced-uses-of-miso">Advanced uses of MISO</a></li>
<li class="toctree-l1"><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="#authors">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="#installing-python-only-miso-version">Installing Python-only MISO version</a></li>
<li class="toctree-l1"><a class="reference internal" href="#references">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#related-software">Related software</a></li>
<li class="toctree-l2"><a class="reference internal" href="#related-reading">Related reading</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="#">MISO</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="#">Docs</a> &raquo;</li>
      
    <li>MISO (Mixture of Isoforms) software documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="https://github.com/yarden/MISO/blob/fastmiso/docs/source/index.rst" class="fa fa-github"> Edit on GitHub</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="miso-mixture-of-isoforms-software-documentation">
<h1>MISO (Mixture of Isoforms) software documentation<a class="headerlink" href="#miso-mixture-of-isoforms-software-documentation" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="_images/MISO-docs-logo-small.png"><img alt="A pipeline of RNA-Seq samples as bowls of MISO soup (graphic by Lou Eisenman)" class="align-right" src="_images/MISO-docs-logo-small.png" style="width: 315.0px; height: 257.6px;" /></a>
<div class="toctree-wrapper compound">
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">MISO (Mixture of Isoforms) software documentation</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#what-is-miso">What is MISO?</a></li>
<li class="toctree-l1"><a class="reference internal" href="#how-miso-works">How MISO works</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#features">Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#mailing-list">Mailing list</a></li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#releases">Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#latest-version-from-github">Latest version from GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-requirements">Installation requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-fastmiso-version-of-miso">Installing the <tt class="docutils literal"><span class="pre">fastmiso</span></tt> version of MISO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-using-a-stable-release">Installing using a stable release</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-latest-version-from-github-repository">Installing the latest version from GitHub repository</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing-the-installation">Testing the installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-miso">Testing MISO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="#ways-of-running-miso-and-associated-file-formats">Ways of running MISO and associated file formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="#using-miso-in-parallel-on-multiple-cores">Using MISO in parallel on multiple cores</a></li>
<li class="toctree-l1"><a class="reference internal" href="#using-miso-on-a-cluster">Using MISO on a cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="#alternative-event-annotations">Alternative event annotations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expanded-alternative-cleavage-and-polyadenylation-annotation-for-mouse">Expanded alternative cleavage and polyadenylation annotation for mouse</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gff-based-alternative-events-format">GFF-based alternative events format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mapping-of-alternative-events-to-genes">Mapping of alternative events to genes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-gff-event-annotations-with-paired-end-reads">Using GFF event annotations with paired-end reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="#human-mouse-gene-models-for-isoform-centric-analyses">Human/mouse gene models for isoform-centric analyses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#running-miso">Running MISO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#invoking-miso-from-the-command-line">Invoking MISO from the command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-the-rna-seq-reads">Preparing the RNA-Seq reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-the-alternative-isoforms-annotation">Preparing the alternative isoforms annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-miso">Configuring MISO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-expression-estimates-psi-psi-values">Computing expression estimates (&#8220;Psi&#8221; / Ψ values)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-single-end-reads">Using single-end reads</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-paired-end-reads">Using paired-end reads</a></li>
<li class="toctree-l3"><a class="reference internal" href="#computing-the-insert-length-distribution-and-its-statistics">Computing the insert length distribution and its statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prefiltering-miso-events">Prefiltering MISO events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distributing-miso-jobs-to-a-cluster">Distributing MISO jobs to a cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="#raw-miso-output-format">Raw MISO output format</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#summarizing-miso-output">Summarizing MISO output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#summary-file-output-format">Summary file output format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#detecting-differentially-expressed-isoforms">Detecting differentially expressed isoforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#output-of-samples-comparison">Output of samples comparison</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bayes-factors-file-output-format">Bayes factors file output format</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#compressing-raw-miso-output">Compressing raw MISO output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#packing-miso-output">Packing MISO output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#long-term-archival-and-compression-of-miso-output">Long-term archival and compression of MISO output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#example-miso-pipeline">Example MISO pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="#interpreting-and-filtering-miso-output">Interpreting and filtering MISO output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-the-read-class-counts">Using the read class counts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-confidence-intervals">Using the confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering-differentially-expressed-events">Filtering differentially expressed events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#visualizing-and-plotting-miso-output">Visualizing and plotting MISO output</a></li>
<li class="toctree-l1"><a class="reference internal" href="#updates">Updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="#frequently-asked-questions-faq">Frequently Asked Questions (FAQ)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#answers">Answers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#advanced-uses-of-miso">Advanced uses of MISO</a></li>
<li class="toctree-l1"><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="#authors">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="#installing-python-only-miso-version">Installing Python-only MISO version</a></li>
<li class="toctree-l1"><a class="reference internal" href="#references">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#related-software">Related software</a></li>
<li class="toctree-l2"><a class="reference internal" href="#related-reading">Related reading</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#probabilistic-models-in-computational-biology">Probabilistic models in computational biology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bayes-factors-and-bayesian-hypothesis-testing">Bayes factors and Bayesian hypothesis testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-reading-on-probabilistic-modeling-and-inference">General reading on probabilistic modeling and inference</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="what-is-miso">
<h1>What is MISO?<a class="headerlink" href="#what-is-miso" title="Permalink to this headline">¶</a></h1>
<p>MISO (Mixture-of-Isoforms) is a probabilistic framework that
quantitates the expression level of alternatively spliced genes from
RNA-Seq data, and identifies differentially regulated isoforms or
exons across samples. By modeling the generative process by which
reads are produced from isoforms in RNA-Seq, the MISO model uses
Bayesian inference to compute the probability that a read originated
from a particular isoform.</p>
<p>The MISO framework is described in Katz et. al., <a class="reference external" href="http://www.nature.com/nmeth/journal/v7/n12/full/nmeth.1528.html">Analysis and design of RNA sequencing experiments for identifying isoform regulation</a>. <em>Nature Methods</em> (2010).</p>
</div>
<div class="section" id="how-miso-works">
<h1>How MISO works<a class="headerlink" href="#how-miso-works" title="Permalink to this headline">¶</a></h1>
<p>MISO treats the expression level of a set of isoforms as a random
variable and estimates a distribution over the values of this
variable. The estimation algorithm is based on sampling, and falls in
the family of techniques known as Markov Chain Monte Carlo (&#8220;MCMC&#8221;).
For details of the inference procedure, see Katz et. al. (2010).</p>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Estimates of isoform expression (Ψ values, for &#8220;Percent Spliced In&#8221; or &#8220;Percent Spliced Isoform&#8221;) and differential
isoform expression for single-end or paired-end RNA-Seq data</li>
<li>Expression estimates at the alternative splicing event level
(&#8220;exon-centric&#8221; analysis) or at the whole mRNA isoform-level (&#8220;isoform-centric&#8221; analysis)</li>
<li>Confidence intervals for expression estimates and quantitative
measures of differential expression (&#8220;Bayes factors&#8221;)</li>
<li>Basic functionality for use on cluster / distributed computing
system</li>
</ul>
</div>
</div>
<div class="section" id="mailing-list">
<h1>Mailing list<a class="headerlink" href="#mailing-list" title="Permalink to this headline">¶</a></h1>
<p>Mailing list where users can ask technical questions is available at <a class="reference external" href="http://mailman.mit.edu/mailman/listinfo/miso-users">miso-users</a> (<a class="reference external" href="http://mailman.mit.edu/mailman/listinfo/miso-users">http://mailman.mit.edu/mailman/listinfo/miso-users</a>).</p>
</div>
<div class="section" id="installation">
<span id="id1"></span><h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>The primary version of MISO is called <tt class="docutils literal"><span class="pre">fastmiso</span></tt> &#8211; which is written in a combination of Python and the C programming language.</p>
<p>To install MISO, either download one of the stable releases (see <a class="reference internal" href="#releases"><em>Releases</em></a>) or install the latest version from our GitHub repository. See below for detailed installation instructions.</p>
<div class="section" id="releases">
<span id="id2"></span><h2>Releases<a class="headerlink" href="#releases" title="Permalink to this headline">¶</a></h2>
<p>MISO is available as a Python package, listed as <tt class="docutils literal"><span class="pre">misopy</span></tt> in <a class="reference external" href="http://pypi.python.org/pypi/misopy/">pypi</a> (Python Package Index).</p>
<p><strong>Stable releases:</strong></p>
<ul class="simple">
<li>MISO version 0.5.2 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.5.2.tar.gz">misopy-0.5.2.tar.gz</a>), March 11, 2014 release (<strong>Most recent</strong>)</li>
<li>MISO version 0.5.1 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.5.1.tar.gz">misopy-0.5.1.tar.gz</a>), February 23, 2014 release</li>
<li>MISO version 0.5.0 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.5.0.tar.gz">misopy-0.5.0.tar.gz</a>), February 21, 2014 release</li>
<li>MISO version 0.4.9 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.9.tar.gz">misopy-0.4.9.tar.gz</a>), April 26, 2013 release</li>
<li>MISO version 0.4.8 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.8.tar.gz">misopy-0.4.8.tar.gz</a>), April 14, 2013 release</li>
<li>MISO version 0.4.7 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.7.tar.gz">misopy-0.4.7.tar.gz</a>), Christmas, 2013 release</li>
<li>MISO version 0.4.6 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.6.tar.gz">misopy-0.4.6.tar.gz</a>), September 27, 2012 release</li>
<li>MISO version 0.4.5 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.5.tar.gz">misopy-0.4.5.tar.gz</a>), September 4, 2012 release</li>
<li>MISO version 0.4.4 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.4.tar.gz">misopy-0.4.4.tar.gz</a>), July 26, 2012 release</li>
<li>MISO version 0.4.3 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.3.tar.gz">misopy-0.4.3.tar.gz</a>), June 1, 2012 release</li>
<li>MISO version 0.4.2 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.2.tar.gz">misopy-0.4.2.tar.gz</a>), May 4, 2012 release</li>
<li>MISO version 0.4.1 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.1.tar.gz">misopy-0.4.1.tar.gz</a>), February 1, 2012 release</li>
<li>MISO version 0.4 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.4.tar.gz">misopy-0.4.tar.gz</a>), January 13, 2012 release</li>
<li>MISO version 0.3 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.3.tar.gz">misopy-0.3.tar.gz</a>), January 8, 2012 release</li>
<li>MISO version 0.2 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.2.tar.gz">misopy-0.2.tar.gz</a>), January 3, 2012 release</li>
<li>MISO version 0.1 (<a class="reference external" href="http://pypi.python.org/packages/source/m/misopy/misopy-0.1.tar.gz">misopy-0.1.tar.gz</a>), Christmas, 2012 release</li>
</ul>
</div>
<div class="section" id="latest-version-from-github">
<h2>Latest version from GitHub<a class="headerlink" href="#latest-version-from-github" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Download latest MISO version from <tt class="docutils literal"><span class="pre">fastmiso</span></tt> GitHub <a class="reference external" href="https://github.com/yarden/MISO">repository</a> (.zip): <a class="reference external" href="https://github.com/yarden/MISO/zipball/fastmiso">https://github.com/yarden/MISO/zipball/fastmiso</a></li>
</ul>
</div>
<div class="section" id="installation-requirements">
<h2>Installation requirements<a class="headerlink" href="#installation-requirements" title="Permalink to this headline">¶</a></h2>
<p>MISO requires a small number of Python modules and commonly used software like <cite>samtools</cite> for accessing SAM/BAM files. The requirements are:</p>
<p><strong>Required Python modules:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><a class="reference external" href="http://www.python.org">Python 2.6</a> or higher</li>
<li><a class="reference external" href="http://www.numpy.org">numpy</a> and <a class="reference external" href="http://www.scipy.org">scipy</a>. <strong>Note</strong>: MISO requires numpy version &gt; 1.5!</li>
<li><a class="reference external" href="http://code.google.com/p/pysam/">pysam</a>, a Python library for working with SAM/BAM files through <tt class="docutils literal"><span class="pre">samtools</span></tt> (<strong>Note</strong>: MISO requires pysam version 0.6 or higher)</li>
<li><a class="reference external" href="http://matplotlib.sourceforge.net/">matplotlib</a>: Only required for use with <tt class="docutils literal"><span class="pre">sashimi_plot</span></tt> for plotting</li>
</ol>
</div></blockquote>
<p><strong>Other required software:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><a class="reference external" href="http://samtools.sourceforge.net/">samtools</a> for accessing SAM/BAM files</li>
<li><a class="reference external" href="http://code.google.com/p/bedtools/">bedtools</a>: optional, used for computing overlaps and intersections BAM/GFF files by certain features of MISO (like prefiltering and paired-end insert length computation.)</li>
</ol>
</div></blockquote>
<p>We strongly recommend that you install MISO using a Python package manager (see <a class="reference internal" href="#installing-fastmiso"><em>Installing the fastmiso version of MISO</em></a>) so that the required Python modules are automatically installed and managed for you.</p>
</div>
<div class="section" id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h2>
<p>To quickly start using MISO, follow these steps (each of which is described in detail in the rest of the manual):</p>
<ol class="arabic">
<li><p class="first"><strong>Choose your GFF annotation set</strong> (see <a class="reference internal" href="#event-annotation"><em>Alternative event annotations</em></a> for our own annotations, available for human, mouse and fruit fly genomes.)</p>
</li>
<li><p class="first"><strong>Index the annotation</strong> using <tt class="docutils literal"><span class="pre">index_gff</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>index_gff --index SE.gff3 indexed_SE_events/
</pre></div>
</div>
</li>
</ol>
<p>where <tt class="docutils literal"><span class="pre">SE.gff3</span></tt> is a GFF file containing descriptions of isoforms/alternative splicing events to be quantitated (e.g. skipped exons).</p>
<ol class="arabic simple" start="3">
<li><strong>Run MISO:</strong></li>
</ol>
<blockquote>
<div><ul>
<li><p class="first">Use <tt class="docutils literal"><span class="pre">miso</span></tt> to get isoform expression estimates, optionally using a cluster to run jobs in parallel, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre>miso --run indexed_SE_events/ my_sample1.bam --output-dir my_output1/ --read-len 36 --use-cluster
miso --run indexed_SE_events/ my_sample2.bam --output-dir my_output2/ --read-len 36 --use-cluster
</pre></div>
</div>
</li>
</ul>
<blockquote>
<div><p>where <tt class="docutils literal"><span class="pre">indexed_SE_events</span></tt> is a directory containing the indexed skipped exon events. <strong>Optionally</strong>, you can pack the MISO output to reduce the space and number of files taken up by the output:</p>
<div class="highlight-python"><div class="highlight"><pre>miso_pack --pack my_output1/
miso_pack --pack my_output2/
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p class="first"><strong>Summarize MISO inferences</strong> using <tt class="docutils literal"><span class="pre">summarize_miso</span> <span class="pre">--summarize-samples</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>summarize_miso --summarize-samples my_output1/ summaries/
summarize_miso --summarize-samples my_output2/ summaries/
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<ol class="arabic" start="4">
<li><p class="first"><strong>Make pairwise comparisons</strong> between samples to detect differentially expressed isoforms/events with <tt class="docutils literal"><span class="pre">compare_miso</span> <span class="pre">--compare-samples</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>compare_miso --compare-samples my_output1/ my_output2/ comparison_output/
</pre></div>
</div>
</li>
<li><p class="first"><strong>Parse and filter</strong> significant events with sufficient coverage.</p>
</li>
</ol>
<p>For a full example of running MISO, see <a class="reference internal" href="#pipeline"><em>Example MISO pipeline</em></a>. Also see the <a class="reference internal" href="#faq"><em>Frequently Asked Questions (FAQ)</em></a> page.</p>
<ol class="arabic simple" start="6">
<li>See <a class="reference external" href="glossary.html">MISO glossary</a> for quick explanations of MISO terminology.</li>
</ol>
</div>
<div class="section" id="installing-the-fastmiso-version-of-miso">
<span id="installing-fastmiso"></span><h2>Installing the <tt class="docutils literal"><span class="pre">fastmiso</span></tt> version of MISO<a class="headerlink" href="#installing-the-fastmiso-version-of-miso" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">fastmiso</span></tt> version of MISO is written in a combination of C and Python. The underlying statistical inference engine is written in C and can be compiled on Mac OS X or Unix-like platforms using GCC or other standard compilers. The interface to this code is written in Python and is identical in its commands and input and output formats to the original Python-only version of MISO. (The Python-only version of MISO is now deprecated.)</p>
<p>There are two options for installing MISO, using either a stable release or installing the latest version from GitHub.</p>
<div class="section" id="installing-using-a-stable-release">
<h3>Installing using a stable release<a class="headerlink" href="#installing-using-a-stable-release" title="Permalink to this headline">¶</a></h3>
<p>It is highly recommended to install Python packages using a package manager such as the <a class="reference external" href="http://pypi.python.org/pypi/pip">pip</a> utility (see <a class="reference external" href="https://python-packaging-user-guide.readthedocs.org/en/latest/installing.html">Python packaging tools tutorial</a> for straightforward instructions on getting started.) Package managers will automatically download and install all necessary requirements for MISO and save headaches later on.
To install a stable release package of MISO using a Python package <tt class="docutils literal"><span class="pre">pip</span></tt>, simply type:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install misopy
</pre></div>
</div>
<p>This will install MISO globally, fetching and installing all of its required Python modules. To install MISO locally (without needing global installation access), it is best to use <a class="reference external" href="http://virtualenv.readthedocs.org/en/latest/">virtualenv</a> in combination with <tt class="docutils literal"><span class="pre">pip</span></tt>. <tt class="docutils literal"><span class="pre">virtualenv</span></tt> will create a &#8220;virtual environment&#8221; where a package and all of its dependencies can be installed. The virtual environment can be loaded whenever needed and so it will not interfere with other (potentially conflicting) Python packages that are available on the system. If you&#8217;re a user working on a cluster system where you don&#8217;t have root privileges, all you need is <tt class="docutils literal"><span class="pre">pip</span></tt> and <tt class="docutils literal"><span class="pre">virtualenv</span></tt> to be available &#8211; the remaining installation steps can all be done locally without root access. To start, create a virtual environment (in this case called <tt class="docutils literal"><span class="pre">myenv</span></tt>) in a local directory to which you have write access (e.g. your home directory):</p>
<div class="highlight-python"><div class="highlight"><pre>virtualenv myenv
</pre></div>
</div>
<p>This will create a directory <tt class="docutils literal"><span class="pre">myenv/</span></tt> that contains a Python virtual environment. Next, install MISO in this local environment:</p>
<div class="highlight-python"><div class="highlight"><pre>myenv/bin/pip install misopy
</pre></div>
</div>
<p>Finally, activate the environment in order to make all the executable MISO scripts available:</p>
<div class="highlight-python"><div class="highlight"><pre>source myenv/bin/activate
</pre></div>
</div>
<p>This completes a local installation of the MISO Python package. To test the installation, load Python and import the <tt class="docutils literal"><span class="pre">misopy</span></tt> and <tt class="docutils literal"><span class="pre">pysplicing</span></tt> packages in the interpreter:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt; import misopy
&gt;&gt; import pysplicing
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">miso</span></tt> main executable should be available on your path now:</p>
<div class="highlight-python"><div class="highlight"><pre>$ miso
MISO (Mixture of Isoforms model)
Probabilistic analysis of RNA-Seq data for detecting differential isoforms
Use --help argument to view options.
</pre></div>
</div>
<p>If you get no errors, the installation completed successfully. Note that MISO also needs <tt class="docutils literal"><span class="pre">samtools</span></tt> to be installed and available on your path.</p>
</div>
<div class="section" id="installing-the-latest-version-from-github-repository">
<h3>Installing the latest version from GitHub repository<a class="headerlink" href="#installing-the-latest-version-from-github-repository" title="Permalink to this headline">¶</a></h3>
<p>To install the latest version from the GitHub <a class="reference external" href="https://github.com/yarden/MISO">repository</a>, there are two options: (a) using <tt class="docutils literal"><span class="pre">git</span></tt> to get the latest source from our GitHub repository, or (b) by downloading a snapshot of the current repository, without going through <tt class="docutils literal"><span class="pre">git</span></tt>. If you have <tt class="docutils literal"><span class="pre">git</span></tt> installed and configured with your GitHub account, you can clone our repository as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>git clone git://github.com/yarden/MISO.git
</pre></div>
</div>
<p>This will create a directory called <tt class="docutils literal"><span class="pre">MISO</span></tt>, containing the repository. Alternatively, if you do not want to go through <tt class="docutils literal"><span class="pre">git</span></tt>, you can download a zip file containing the latest MISO GitHub release (following this link: <a class="reference external" href="https://github.com/yarden/MISO/zipball/fastmiso">https://github.com/yarden/MISO/zipball/fastmiso</a>). This zip file has to be unzipped (e.g. using <tt class="docutils literal"><span class="pre">unzip</span> <span class="pre">fastmiso</span></tt> on Unix systems) and contains the latest release of the MISO repository.</p>
<p>Next, compile the code and install MISO using the Python package manager (such as as <a class="reference external" href="http://pypi.python.org/pypi/pip">pip</a> or <a href="#id43"><span class="problematic" id="id44">`easy_install`_</span></a>) as described above. We strongly recommend that you manage Python packages using a package manager rather than manually installing packages and modifying your <tt class="docutils literal"><span class="pre">PYTHONPATH</span></tt>, which is error prone and time consuming.</p>
</div>
</div>
<div class="section" id="testing-the-installation">
<span id="id3"></span><h2>Testing the installation<a class="headerlink" href="#testing-the-installation" title="Permalink to this headline">¶</a></h2>
<p>To test if the required modules are available, use the
<tt class="docutils literal"><span class="pre">module_availability</span></tt> script as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>$ module_availability
Checking for availability of: numpy
Checking for availability of: scipy
...
All modules are available!
</pre></div>
</div>
<p>It is crucial that the <tt class="docutils literal"><span class="pre">samtools</span></tt> command is available from the
default path environment, or else MISO will not be able to parse
SAM/BAM files. On a Unix or a Mac OS X system, you should be able to
type <tt class="docutils literal"><span class="pre">samtools</span></tt> at the prompt and get access to the program without
specifying any path prefix.</p>
<p>To test that the MISO packages are properly installed, verify that the two modules <tt class="docutils literal"><span class="pre">misopy</span></tt> and <tt class="docutils literal"><span class="pre">pysplicing</span></tt> are available from your Python environment:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt; import misopy
&gt;&gt; import pysplicing
</pre></div>
</div>
<p>You should be able to import both of these packages without errors from the Python interpreter. The <tt class="docutils literal"><span class="pre">misopy</span></tt> package is the main MISO package, containing utilities for analyzing RNA-Seq data and plotting it (including <a class="reference external" href="sashimi.html">sashimi_plot</a>). The <tt class="docutils literal"><span class="pre">pysplicing</span></tt> package is an under-the-hood interface between Python and the statistical inference engine written in C.</p>
</div>
<div class="section" id="testing-miso">
<h2>Testing MISO<a class="headerlink" href="#testing-miso" title="Permalink to this headline">¶</a></h2>
<p>To test that MISO can be run properly, run <tt class="docutils literal"><span class="pre">test_miso</span></tt> as shown
below. These tests ensure that MISO can be run on a few
genes/exons. The output of these tests can be ignored and the
abbreviated version should be along the following lines:</p>
<div class="highlight-python"><div class="highlight"><pre>$ test_miso
Testing conversion of SAM to BAM...
...output omitted...
Computing Psi for 1 genes...
...
----------------------------------------------------------------------
Ran 3 tests in 68.000s
OK
</pre></div>
</div>
<p>If you see errors prior to this, the most likely cause is that some dependency
is not installed or not available in the path environment. For
example, if <tt class="docutils literal"><span class="pre">samtools</span></tt> is installed but missing from the path
(i.e. not accessible from the shell), that will cause errors in the
test run.</p>
</div>
</div>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>To run MISO, a set of annotations (typically specified in GFF format) of the isoforms of alternative
events must be provided and RNA-Seq reads (typically specified in SAM format). The GFF annotation is
indexed into an efficient representation using a script provided by MISO. The SAM reads must be sorted
and indexed into the BAM format (binary version of SAM) before they can be used with MISO.</p>
<p>The sections that follow describe in detail the file formats used for the annotation and for the reads
and the specific steps that are required to run MISO. An example of a
MISO pipeline for computing isoform expression estimates and detecting
differentially expressed isoforms is given in <a class="reference internal" href="#pipeline"><em>Example MISO pipeline</em></a>.</p>
<p>The figure below shows an overview of how to run MISO.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/MISO-graphical-pipeline.png"><img alt="Overview of how to run MISO" class="align-center" src="_images/MISO-graphical-pipeline.png" style="width: 815.1px; height: 916.2px;" /></a>
</div></blockquote>
</div>
<div class="section" id="ways-of-running-miso-and-associated-file-formats">
<h1>Ways of running MISO and associated file formats<a class="headerlink" href="#ways-of-running-miso-and-associated-file-formats" title="Permalink to this headline">¶</a></h1>
<p>MISO can be run on either single or paired-end RNA-Seq data. Two general kinds of analyses are possible:</p>
<ol class="arabic simple">
<li>Estimate expression level of exons (<strong>&#8220;exon-centric&#8221; analysis</strong>) or,</li>
<li>Estimate expression level of whole transcripts (<strong>&#8220;isoform-centric&#8221; analysis</strong>)</li>
</ol>
<p>Exon-centric analyses are recommended for looking at alternative splicing at the level of individual
splicing events, e.g. the inclusion levels of a particular skipped exon, or the use of a particular
alternative splice site. In isoform-centric analyses the expression level of whole isoforms for genes are estimated (i.e. the
expression of each individual isoform of a gene is estimated). Both of these analysis modes have merits and disadvantages. Exon-centric analyses are typically easier to interpret and validate experimentally, but do not always capture the complexity of a set related splicing events within a gene. Isoform-centric analyses capture more of this complexity, but are limited by the typically short length of RNA-Seq reads, and inaccuracies or incompleteness in the annotation of the gene&#8217;s isoforms. Estimates of isoform-level expression are also harder to validate in the lab using traditional techniques such as RT-PCR.</p>
<p>To run MISO, an annotation of the alternative splicing events or isoforms must be provided and
a set of reads. Single or paired-end reads can be provided in the <a class="reference external" href="http://samtools.sourceforge.net/SAM1.pdf">Spliced Alignment/Map (SAM)</a> format (in its binary form, BAM) and the annotation can be in the <a class="reference external" href="http://www.sequenceontology.org/gff3.shtml">GFF</a> (version 3) format. The GFF format can be used to specify either whole mRNA isoforms of genes (which is the common use of the format) or to specify single alternative splicing events, as described in <a class="reference internal" href="#event-annotation"><em>Alternative event annotations</em></a>.</p>
</div>
<div class="section" id="using-miso-in-parallel-on-multiple-cores">
<h1>Using MISO in parallel on multiple cores<a class="headerlink" href="#using-miso-in-parallel-on-multiple-cores" title="Permalink to this headline">¶</a></h1>
<p>When run locally and not on a cluster, MISO will use multiple cores on the machine
on which it is running. The number of cores/processors to be used by MISO is set
through the settings file (see <a class="reference internal" href="sashimi.html#config"><em>Visualizing RNA-Seq reads along isoforms with MISO estimates</em></a>).</p>
</div>
<div class="section" id="using-miso-on-a-cluster">
<h1>Using MISO on a cluster<a class="headerlink" href="#using-miso-on-a-cluster" title="Permalink to this headline">¶</a></h1>
<p>It is highly recommended to run MISO on a cluster when possible. Since each
gene/exon can be treated as an independent inference problem, MISO is
highly parallelizable, and the use of multiple computers can cut run times
down by orders of magnitude.</p>
<p>MISO comes with basic functionality for running on a cluster, assuming
that there&#8217;s a shared filesystem between all the nodes.</p>
</div>
<div class="section" id="alternative-event-annotations">
<span id="event-annotation"></span><h1>Alternative event annotations<a class="headerlink" href="#alternative-event-annotations" title="Permalink to this headline">¶</a></h1>
<p>Alternative event annotations are available for the major classes of alternative
splicing and alternative RNA processing events in the human (hg18, hg19), mouse (mm9) and Drosophila melanogaster genomes.
The event types covered are:</p>
<ol class="arabic simple">
<li>Skipped exons (SE)</li>
<li>Alternative 3&#8217;/5&#8217; splice sites (A3SS, A5SS)</li>
<li>Mutually exclusive exons (MXE)</li>
<li>Tandem 3&#8217; UTRs (TandemUTR)</li>
<li>Retained introns (RI)</li>
<li>Alternative first exons (AFE)</li>
<li>Alternative last exons (ALE)</li>
</ol>
<p>These annotations can be downloaded from the <a class="reference external" href="annotation.html">MISO annotations page</a>.</p>
<p>For performing isoform-centric analyses, any gene models annotation can be used (e.g. from Ensembl, UCSC or RefSeq) as long as it is specified in the GFF3 format. As an example, we provide GFF3 annotations from Ensembl (which were converted from Ensembl&#8217;s GTF format to GFF3), available in <a class="reference internal" href="#iso-centric"><em>Human/mouse gene models for isoform-centric analyses</em></a>.</p>
<div class="section" id="expanded-alternative-cleavage-and-polyadenylation-annotation-for-mouse">
<span id="tian-apa"></span><h2>Expanded alternative cleavage and polyadenylation annotation for mouse<a class="headerlink" href="#expanded-alternative-cleavage-and-polyadenylation-annotation-for-mouse" title="Permalink to this headline">¶</a></h2>
<p>A recent paper from Bin Tian&#8217;s group, <a class="reference external" href="http://www.nature.com/nmeth/journal/vaop/ncurrent/abs/nmeth.2288.html">Analysis of alternative cleavage and polyadenylation by 3′ region extraction and deep sequencing</a>, annotated alternative cleavage and polyadenylation events in mouse tissues using the <em>3′READS</em> method. The annotated events (TandemUTR and ALE) are available in GFF format on the <a class="reference external" href="annotation.html">MISO annotations page</a>, courtesy of the Tian group.</p>
</div>
<div class="section" id="gff-based-alternative-events-format">
<span id="gff-event-annotation"></span><h2>GFF-based alternative events format<a class="headerlink" href="#gff-based-alternative-events-format" title="Permalink to this headline">¶</a></h2>
<p>Single alternative splicing events can be described in GFF format, using the convention
described below. In the mouse and human genome event annotations in <a class="reference internal" href="#event-annotation"><em>Alternative event annotations</em></a>,
alternative splicing events that produce two isoforms are described.
For example, here is a skipped exon from the set of mouse skipped exons annotation (Version 1):</p>
<div class="highlight-python"><div class="highlight"><pre>chr1  SE      gene    4772649 4775821 .       -       .       ID=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-;Name=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-
chr1  SE      mRNA    4772649 4775821 .       -       .       ID=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.A;Parent=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-
chr1  SE      mRNA    4772649 4775821 .       -       .       ID=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.B;Parent=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-
chr1  SE      exon    4775654 4775821 .       -       .       ID=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.A.up;Parent=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.A
chr1  SE      exon    4774032 4774186 .       -       .       ID=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.A.se;Parent=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.A
chr1  SE      exon    4772649 4772814 .       -       .       ID=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.A.dn;Parent=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.A
chr1  SE      exon    4775654 4775821 .       -       .       ID=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.B.up;Parent=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.B
chr1  SE      exon    4772649 4772814 .       -       .       ID=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.B.dn;Parent=chr1:4775654:4775821:-@chr1:4774032:4774186:-@chr1:4772649:4772814:-.B
</pre></div>
</div>
<p>The ID of the exon was chosen arbitrarily to be <tt class="docutils literal"><span class="pre">chr1:4775654:4775821:-&#64;chr1:4774032:4774186:-&#64;chr1:4772649:4772814:-</span></tt>. This name encodes the genomic coordinates of the upstream (5&#8217;) exon, the skipped exon, and
the downstream (3&#8217;) exon of this alternative splicing event, separated by <tt class="docutils literal"><span class="pre">&#64;</span></tt> symbols. The two isoforms that result (encoded as <tt class="docutils literal"><span class="pre">mRNA</span></tt> entries in the file) are: (1) the isoform made up of the upstream exon, the skipped exon and the
downstream exon (isoform where the exon is included), (2) the isoform made up of the upstream
exon followed by the downstream exon (isoform where the exon is skipped.) Note that we only use
the two flanking exons in this annotation, but one could modify the annotation to include arbitrarily many
flanking exons from the transcripts. We chose to name the two <tt class="docutils literal"><span class="pre">mRNA</span></tt> entries as the coordinates of the
exons that make up the mRNA followed by <tt class="docutils literal"><span class="pre">A</span></tt> for the first isoform, <tt class="docutils literal"><span class="pre">B</span></tt> for the second, though these
naming conventions are arbitrary and do not have to be used. Similarly, the ID of each exon is encoded
as its coordinate followed by <tt class="docutils literal"><span class="pre">up</span></tt>, <tt class="docutils literal"><span class="pre">se</span></tt> or <tt class="docutils literal"><span class="pre">dn</span></tt> to denote the upstream, skipped or downstream
exons, respectively.</p>
</div>
<div class="section" id="mapping-of-alternative-events-to-genes">
<span id="events-to-genes"></span><h2>Mapping of alternative events to genes<a class="headerlink" href="#mapping-of-alternative-events-to-genes" title="Permalink to this headline">¶</a></h2>
<p>A mapping from alternative events to genes can be downloaded from the <a class="reference external" href="annotation.html">MISO annotations page</a>.</p>
</div>
<div class="section" id="using-gff-event-annotations-with-paired-end-reads">
<h2>Using GFF event annotations with paired-end reads<a class="headerlink" href="#using-gff-event-annotations-with-paired-end-reads" title="Permalink to this headline">¶</a></h2>
<p>Note that in the above GFF annotations for events, only immediately flanking exons to an alternative event are considered.
For example, for a skipped exon event, only the two exons that flank it are considered in the annotation. In the human/mouse genomes,
this means that the two isoforms produced the event would be roughly ~400 nt and ~300 nt long. Modified annotations
that use more of the exons present in the two isoforms might be more appropriate for use with long insert length paired-end
libraries where the average insert is significantly longer than these isoform lengths. This in general will not affect isoform-centric analyses, where the entire mRNA transcript is used as the annotation to quantitate.</p>
</div>
<div class="section" id="human-mouse-gene-models-for-isoform-centric-analyses">
<span id="iso-centric"></span><h2>Human/mouse gene models for isoform-centric analyses<a class="headerlink" href="#human-mouse-gene-models-for-isoform-centric-analyses" title="Permalink to this headline">¶</a></h2>
<p>For isoform-centric analyses, annotations of gene models are needed, where whole mRNA isoforms are specified for each gene. Any annotation that is in GFF3 format can be used, e.g. annotations obtained from RefSeq, Ensembl, UCSC or other databases.</p>
<p>Annotations can be converted from UCSC table formats or from GTF format into GFF3 using the following procedure:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Download your gene annotation (e.g. Ensembl genes, RefSeq) from UCSC Table Browser. For example, an Ensembl genes table <tt class="docutils literal"><span class="pre">ensGene.txt</span></tt> can be downloaded for the <tt class="docutils literal"><span class="pre">mm9</span></tt> genome from UCSC goldenPath here (<a class="reference external" href="http://hgdownload.cse.ucsc.edu/goldenPath/mm9/database/ensGene.txt.gz">http://hgdownload.cse.ucsc.edu/goldenPath/mm9/database/ensGene.txt.gz</a>).</li>
<li>To convert this gene table into GFF3, use of these two ways: (a) use the script <a class="reference external" href="http://genes.mit.edu/burgelab/miso/scripts/ucsc_table2gff3.pl">ucsc_table2gff3.pl</a> (from <a class="reference external" href="http://code.google.com/p/biotoolbox/">biotoolbox</a>) to convert the table directly into GFF3, or (b) use the UCSC utility <a class="reference external" href="http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64/">genePredToGtf</a> to convert the table into GTF format (instructions for this are described in <a class="reference external" href="http://genomewiki.ucsc.edu/index.php/Genes_in_gtf_or_gff_format">http://genomewiki.ucsc.edu/index.php/Genes_in_gtf_or_gff_format</a>) and then convert the GTF file into GFF3 using <a class="reference external" href="http://genes.mit.edu/burgelab/miso/scripts/gtf2gff3.pl">gtf2gff3.pl</a>.</li>
</ol>
</div></blockquote>
<p>For convenience, we provide GFF3 annotations based on UCSC Table Browser&#8217;s version of Ensembl genes for the following genomes:</p>
<blockquote>
<div><ul class="simple">
<li>Mouse Ensembl genes from UCSC<ul>
<li>Annotation for mm9: <a class="reference external" href="http://genes.mit.edu/burgelab/miso/annotations/ucsc_tables/mm9/ensGene.gff3">mm9 ensGene GFF annotation</a></li>
<li>Annotation for mm10: <a class="reference external" href="http://genes.mit.edu/burgelab/miso/annotations/ucsc_tables/mm10/ensGene.gff3">mm10 ensGene GFF annotation</a></li>
</ul>
</li>
<li>Human Ensembl genes from UCSC<ul>
<li>Annotation for hg18: <a class="reference external" href="http://genes.mit.edu/burgelab/miso/annotations/ucsc_tables/hg18/ensGene.gff3">hg18 ensGene GFF annotation</a></li>
<li>Annotation for hg19: <a class="reference external" href="http://genes.mit.edu/burgelab/miso/annotations/ucsc_tables/hg19/ensGene.gff3">hg19 ensGene GFF annotation</a></li>
</ul>
</li>
</ul>
</div></blockquote>
<p>It is critical to note that Ensembl and UCSC have distinct chromosome naming conventions (see warning note below). However, Ensembl tables obtained from the UCSC Table Browser will follow the UCSC chromosome naming conventions, not Ensembl&#8217;s, which is why the UCSC-downloaded Ensembl annotations in the GFFs provided above contain <cite>chr</cite> headers. Ensembl annotations obtained directly from Ensembl (e.g. via Ensembl BioMart) will of course follow the Ensembl chromosome naming conventions, and not UCSC&#8217;s.</p>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>The UCSC and Ensembl databases name their chromosomes differently. By convention, UCSC chromosomes start with <tt class="docutils literal"><span class="pre">chr</span></tt> while Ensembl chromosome names do not. UCSC will call the fifth chromosome <tt class="docutils literal"><span class="pre">chr5</span></tt> and Ensembl will call it <tt class="docutils literal"><span class="pre">5</span></tt>. If your GFF annotation uses one convention, but your BAM reads are aligned to distinct <em>headers</em>, i.e. chromosome names following another convention, then none of your reads will map. For example, MISO will try to find all the regions on <tt class="docutils literal"><span class="pre">chr5</span></tt> if your GFF annotation follows the UCSC convention and fail, since all your BAM alignments could be to a header named <tt class="docutils literal"><span class="pre">5</span></tt>, or vice versa. In that case, lines such as these will appear in the MISO output:</p>
<div class="highlight-python"><div class="highlight"><pre>Cannot fetch reads in region: 5:1200-1500
</pre></div>
</div>
<p>We strongly recommend that you check that your BAM files follow the same headers naming convention as your GFF. If you run into a mismatch between your annotation&#8217;s chromosome headers and your BAM file headers, please make sure that the headers that you map to in the read mapping stage to are the same as the headers used in the GFF annotation for MISO. For example, if you use TopHat/Bowtie to map reads and your genome index was made with UCSC-style <tt class="docutils literal"><span class="pre">chr</span></tt> headers but you want to use Ensembl annotations for quantitations, the solution is to:</p>
<blockquote class="last">
<div><ol class="arabic simple">
<li>Download your genome&#8217;s sequence files (<tt class="docutils literal"><span class="pre">*.fa</span></tt>, typically) from Ensembl,</li>
<li>Make a new Bowtie index from these files (using <tt class="docutils literal"><span class="pre">bowtie-build</span></tt>), or the appropriate index for your read mapping program,</li>
<li>Remap your reads against this new index. The resulting mapped SAM/BAM files can be used with the unmodified Ensembl GFF annotations we provide here, where the headers in the GFF are guaranteed to match the headers in the SAM/BAM files (both using Ensembl header conventions.)</li>
</ol>
</div></blockquote>
</div>
</div></blockquote>
<p>For convenience, we also provide GFF3 annotations of gene models from Ensembl (release 65), which were simply converted from Ensembl&#8217;s GTF to GFF3 format and are otherwise identical to the Ensembl annotation.</p>
<blockquote>
<div><ul class="simple">
<li>Mouse Ensembl genes (16 M, .zip): <a class="reference external" href="http://genes.mit.edu/burgelab/miso/annotations/gene-models/Mus_musculus.NCBIM37.65.gff.zip">Mus_musculus.NCBIM37.65.gff</a></li>
<li>Human Ensembl genes (26 M, .zip): <a class="reference external" href="http://genes.mit.edu/burgelab/miso/annotations/gene-models/Homo_sapiens.GRCh37.65.gff.zip">Homo_sapiens.GRCh37.65.gff</a></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="running-miso">
<h1>Running MISO<a class="headerlink" href="#running-miso" title="Permalink to this headline">¶</a></h1>
<div class="section" id="invoking-miso-from-the-command-line">
<h2>Invoking MISO from the command line<a class="headerlink" href="#invoking-miso-from-the-command-line" title="Permalink to this headline">¶</a></h2>
<p>When installing the MISO package, the set of scripts that make up to inteface to MISO will automatically be placed as an executables in your path, so that you can refer to these without modifying your shell environment. For example, if you install MISO using <tt class="docutils literal"><span class="pre">setup.py</span> <span class="pre">install</span></tt> globally, then a MISO script like <tt class="docutils literal"><span class="pre">miso</span></tt> will become available on the path, and can be run as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">miso</span>
</pre></div>
</div>
<p>The path of the Python version on the system used to install MISO will automatically be invoked when running these scripts.</p>
<p>If you installed MISO using <tt class="docutils literal"><span class="pre">setup.py</span> <span class="pre">--prefix=~/</span></tt> in your home directory or some other path, these scripts will typically be placed in a designated executables directory in your home directory, e.g. <tt class="docutils literal"><span class="pre">~/bin/</span></tt>.</p>
</div>
<div class="section" id="preparing-the-rna-seq-reads">
<h2>Preparing the RNA-Seq reads<a class="headerlink" href="#preparing-the-rna-seq-reads" title="Permalink to this headline">¶</a></h2>
<p>MISO can take as input RNA-Seq reads in the <a class="reference external" href="http://samtools.sourceforge.net/SAM1.pdf">SAM</a> format. SAM files are typically the output of read alignment programs, such as <a class="reference external" href="http://bowtie-bio.sourceforge.net/">Bowtie</a> or <a class="reference external" href="http://tophat.cbcb.umd.edu/">Tophat</a>. The SAM format can represent both single and paired-end reads.</p>
<p>Files in SAM format must be converted to an indexed, sorted BAM file that contain headers.
If you have an indexed, sorted BAM file you can move on to the next section.</p>
<p>The right BAM file can be created using <a class="reference external" href="http://samtools.sourceforge.net/">samtools</a> manually, or with the help of the wrapper
script <tt class="docutils literal"><span class="pre">sam_to_bam</span></tt> that calls samtools. For example, to convert <tt class="docutils literal"><span class="pre">my_sample.sam</span></tt> to an
indexed, sorted BAM file with headers specified in <tt class="docutils literal"><span class="pre">mm9_complete.fa.fai</span></tt> and output the result
to the directory <tt class="docutils literal"><span class="pre">my_sample/</span></tt>, use:</p>
<div class="highlight-python"><div class="highlight"><pre>sam_to_bam --convert my_sample.sam my_sample/ --ref mm9_complete.fa.fai
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">mm9_complete.fa.fai</span></tt> is a header file that contains the lengths of each chromosome
in the genome used to create the <tt class="docutils literal"><span class="pre">my_sample.sam</span></tt> file. The .fai files can be created from the
FASTA files of a genome using the <tt class="docutils literal"><span class="pre">faidx</span></tt> option of samtools (e.g. <tt class="docutils literal"><span class="pre">samtools</span> <span class="pre">faidx</span> <span class="pre">genome.fasta</span></tt>).</p>
<p>The <tt class="docutils literal"><span class="pre">sam_to_bam</span></tt> script will output a set of BAM files and their indices (<tt class="docutils literal"><span class="pre">my_sample.bam</span></tt>,
<tt class="docutils literal"><span class="pre">my_sample.sorted.bam</span></tt>, <tt class="docutils literal"><span class="pre">my_sample.sorted.bam.bai</span></tt>) to <tt class="docutils literal"><span class="pre">my_sample/</span></tt>.</p>
</div>
<div class="section" id="preparing-the-alternative-isoforms-annotation">
<span id="indexing-annotation"></span><h2>Preparing the alternative isoforms annotation<a class="headerlink" href="#preparing-the-alternative-isoforms-annotation" title="Permalink to this headline">¶</a></h2>
<p>To quantitate alternative splicing, an annotation file must be provided that describes
the isoforms whose expression should be estimated from data.</p>
<p>To estimate the expression level of whole mRNA transcripts, a GFF format containing a set
of annotated transcripts for each gene can be used. This is the same GFF that can be
given as input to <a class="reference external" href="http://tophat.cbcb.umd.edu/">Tophat</a> in order to incorporate known genomic junctions, for example.
These GFF files can be readily produced for any annotated genome (see <a class="reference internal" href="#iso-centric"><em>Human/mouse gene models for isoform-centric analyses</em></a> for Ensembl-based annotations of this form for human/mouse genomes.)</p>
<p>For exon-centric analyses, a GFF file can be used as well, except such a file will contain
only the subsets of the isoforms produced by a particular splicing event &#8211; rather than
whole transcripts &#8211; as described in <a class="reference internal" href="#gff-event-annotation"><em>GFF-based alternative events format</em></a>.  The GFF file chosen has to be
indexed for efficient representation. A set of indexed, ready-to-use events is available for the
mouse and human genomes.</p>
<p>To create an index for the GFF annotations, the <tt class="docutils literal"><span class="pre">index_gff</span></tt> script can be used as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>index_gff --index SE.mm9.gff indexed/
</pre></div>
</div>
<p>This will index the GFF file <tt class="docutils literal"><span class="pre">SE.mm9.gff</span></tt> and output the result to the <tt class="docutils literal"><span class="pre">indexed/</span></tt> directory.
This indexed directory is then used as input to MISO.</p>
</div>
<div class="section" id="configuring-miso">
<span id="config"></span><h2>Configuring MISO<a class="headerlink" href="#configuring-miso" title="Permalink to this headline">¶</a></h2>
<p>The default configuration file for MISO is available in <tt class="docutils literal"><span class="pre">settings/miso_settings.txt</span></tt>.
Skip to the next section if you&#8217;d like to use the default configuration file.
The default file is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">data</span><span class="p">]</span>
<span class="n">filter_results</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">min_event_reads</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">strand</span> <span class="o">=</span> <span class="n">fr</span><span class="o">-</span><span class="n">unstranded</span>

<span class="p">[</span><span class="n">cluster</span><span class="p">]</span>
<span class="n">cluster_command</span> <span class="o">=</span> <span class="n">qsub</span>

<span class="p">[</span><span class="n">sampler</span><span class="p">]</span>
<span class="n">burn_in</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">lag</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_iters</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">num_processors</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">[data]</span></tt> section contains parameters related to the way reads should be handled. These are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">filter_results</span></tt>:  Specifies whether or not events should be filtered for coverage (<tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">False</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">min_event_reads</span></tt>: What the minimum number of reads that a region must have for it to be quantitated. The minimum number of reads is computed over the longest genomic region of the gene or alternatively spliced event.</li>
<li><tt class="docutils literal"><span class="pre">strand</span></tt> (optional): What the strand convention of the input BAM files is. Can be set to either <tt class="docutils literal"><span class="pre">fr-unstranded</span></tt>, <tt class="docutils literal"><span class="pre">fr-firststrand</span></tt>, or <tt class="docutils literal"><span class="pre">fr-secondstrand</span></tt>. Set to <tt class="docutils literal"><span class="pre">fr-unstranded</span></tt> by default. See <a class="reference external" href="http://onetipperday.blogspot.com/2012/07/how-to-tell-which-library-type-to-use.html">Note on strand-specificity in RNA-Seq libraries</a> for an explanation of these strand conventions.</li>
</ul>
<p>The <tt class="docutils literal"><span class="pre">[cluster]</span></tt> section specifies parameters related to running MISO on a cluster of computers.
These are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">cluster_command</span></tt>: the name of the program used to submit jobs to the cluster (e.g. <tt class="docutils literal"><span class="pre">qsub</span></tt>, <tt class="docutils literal"><span class="pre">bsub</span></tt>, etc.) MISO will use this command to launch jobs on the cluster system.</li>
<li><tt class="docutils literal"><span class="pre">long_queue_name</span></tt> (optional): the name of the &#8220;long queue&#8221; (jobs that take longer to finish) of the cluster queueing system.</li>
<li><tt class="docutils literal"><span class="pre">short_queue_name</span></tt> (optional): the name of the &#8220;short queue&#8221; (jobs that generally finish quicker and might get priority) of the cluster queueing system. The name of this queue is often <tt class="docutils literal"><span class="pre">short</span></tt> or <tt class="docutils literal"><span class="pre">quick</span></tt> depending on the way the cluster is configured.</li>
</ul>
<p>Both <tt class="docutils literal"><span class="pre">long_queue_name</span></tt> and <tt class="docutils literal"><span class="pre">short_queue_name</span></tt> can be omitted from the configuration file, in which
case jobs will be submitted to the cluster without specifying any queue. All parameters set in the
<tt class="docutils literal"><span class="pre">[clusters]</span></tt> section are only relevant when MISO is used on a cluster.</p>
<p>The <tt class="docutils literal"><span class="pre">[sampler]</span></tt> section specifies internal parameters related to MISO&#8217;s sampling algorithm. Most users
will not want to tweak these. The parameters are as follows:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">burn_in</span></tt>: the number of initial sampling iterations to be discarded before computing estimates.</li>
<li><tt class="docutils literal"><span class="pre">lag</span></tt>: the number of sampling iterations to skip when computing estimates. A lag of 10 would mean every 10th iteration is used.</li>
<li><tt class="docutils literal"><span class="pre">num_iters</span></tt>: the total number of sampling iterations to be computed per gene/event.</li>
<li><tt class="docutils literal"><span class="pre">num_processors</span></tt> (optional): Number of processors to use when running locally using multiple cores. Set to 4 by default. Not used when running on a cluster.</li>
</ul>
<p>The default settings of the sampling-related parameters in <tt class="docutils literal"><span class="pre">[sampler]</span></tt> was deliberately chosen to be conservative.</p>
</div>
<div class="section" id="computing-expression-estimates-psi-psi-values">
<h2>Computing expression estimates (&#8220;Psi&#8221; / Ψ values)<a class="headerlink" href="#computing-expression-estimates-psi-psi-values" title="Permalink to this headline">¶</a></h2>
<p>To run MISO to estimate the expression level of a set of annotated isoforms or events in GFF format,
the <tt class="docutils literal"><span class="pre">miso</span></tt> script is used with the <tt class="docutils literal"><span class="pre">--run</span></tt> option.
This produces distributions over &#8220;Psi&#8221; values (Ψ), which stand for
&#8220;Percent Spliced In&#8221;. See Katz et. al. (2010) for a description of
these values and how they are computed.</p>
<div class="section" id="using-single-end-reads">
<h3>Using single-end reads<a class="headerlink" href="#using-single-end-reads" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">--run</span></tt> takes the following arguments:</p>
<div class="highlight-python"><div class="highlight"><pre>--run
                      Compute Psi values for given GFF annotation.
                      Expects two arguments: an indexed GFF
                      directory with genes to process, and a sorted, indexed
                      BAM file (with headers) to run on.
</pre></div>
</div>
<p>For example, to run on a single-end sample:</p>
<div class="highlight-python"><div class="highlight"><pre>miso --run mm9/pickled/SE data/my_sample.sorted.bam --output-dir my_sample_output/ --read-len 35
</pre></div>
</div>
<p>This will compute expression values for the isoforms described in the indexed GFF directory <tt class="docutils literal"><span class="pre">mm9/pickled/SE</span></tt>, based on the reads in <tt class="docutils literal"><span class="pre">data/my_sample.sorted.bam</span></tt> (a sorted, indexed BAM file) an output the results to the <tt class="docutils literal"><span class="pre">my_sample_output/</span></tt> directory. Note that the <tt class="docutils literal"><span class="pre">mm9/pickled/SE</span></tt> directory in this case must be generated by the user, by running <tt class="docutils literal"><span class="pre">index_gff</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">--read-len</span></tt> option is necessary and specifies the length of the reads in the data (in this case, 35 nt.)  The directory <tt class="docutils literal"><span class="pre">mm9/pickled/SE</span></tt>, which is available in the mouse splicing event annotations, specifies an indexed version of all the skipped exon (SE) events.</p>
<p>Note that that the headers for the indexed/sorted BAM file (the files with the <tt class="docutils literal"><span class="pre">.bam.bai</span></tt> extension)
must be in the same directory as the read BAM file. In the above example, it means they must be in the
<tt class="docutils literal"><span class="pre">data/</span></tt> directory.</p>
<p>If reads were aligned to a set of splice junctions with an <em>overhang</em> constraint &#8212; i.e., a requirement
that N or more bases from each side of the junction must be covered by the read &#8212; then this can be
specified using the <tt class="docutils literal"><span class="pre">--overhang-len</span></tt> option:</p>
<div class="highlight-python"><div class="highlight"><pre>--overhang-len
                      Length of overhang constraints imposed on junctions.
</pre></div>
</div>
</div>
<div class="section" id="using-paired-end-reads">
<h3>Using paired-end reads<a class="headerlink" href="#using-paired-end-reads" title="Permalink to this headline">¶</a></h3>
<p>To compute expression levels using paired-end reads, use the <tt class="docutils literal"><span class="pre">--paired-end</span></tt> option:</p>
<div class="highlight-python"><div class="highlight"><pre>--paired-end
                      Run in paired-end mode. Takes mean and standard
                      deviation of insert length distribution.
</pre></div>
</div>
<p>The insert length distribution gives the range of sizes of fragments sequenced in the
paired-end RNA-Seq run. This is used to assign reads to isoforms probabilistically.
The insert length distribution can be computed by aligning read pairs to long, constitutive
exons (like 3&#8217; UTRs) and measuring the distance between the read mates. The mean and standard
deviation of this distribution would then be given as arguments to <tt class="docutils literal"><span class="pre">--paired-end</span></tt>.
For example, to run on a paired-end sample where the mean insert length is 250 and the standard
deviation is 15, we would use: <tt class="docutils literal"><span class="pre">--paired-end</span> <span class="pre">250</span> <span class="pre">15</span></tt> when calling <tt class="docutils literal"><span class="pre">miso</span></tt>
(in addition to the <tt class="docutils literal"><span class="pre">--run</span></tt> option).</p>
<p>The <tt class="docutils literal"><span class="pre">--overhang-len</span></tt> option is not supported for paired-end reads.</p>
</div>
<div class="section" id="computing-the-insert-length-distribution-and-its-statistics">
<h3>Computing the insert length distribution and its statistics<a class="headerlink" href="#computing-the-insert-length-distribution-and-its-statistics" title="Permalink to this headline">¶</a></h3>
<p>We provide a set of utilities for computing and plotting the insert length distribution in paired-end RNA-Seq samples. The insert length distribution of a sample is computed by aligning the read pairs to long constitutive exons and then measuring the insert length of each pair. The set of insert lengths obtained this way form a distribution, and summary statistics of this distribution &#8211; like its mean and standard deviation &#8211; are used by MISO to assign read pairs to isoforms.</p>
<p>The utilities in <tt class="docutils literal"><span class="pre">exon_utils</span></tt> and <tt class="docutils literal"><span class="pre">pe_utils</span></tt> can be used to first get a set of long constitituve exons to map read pairs to, and second compute the insert length distribution and its statistics.</p>
<p><strong>Getting a set of long constitutive exons</strong>: When computing the insert length distribution, it&#8217;s important to use exons that are significantly larger than the insert length that was selected for in preparing the RNA-Seq library. If the insert length selected for in preparing the RNA-Seq library was roughly 250-300 nt, we can use constitutive exons that are at least 1000 bases long, for example, so that both read pairs will map within the exon and not outside of it. The requirement that the exons be constitutive is to avoid errors in the insert length measurements that are caused by alternative splicing of the exon (which could alter the insert length.)</p>
<p>We first get all constitutive exons from a gene models GFF, like the Ensembl annotation of mouse genes (available here, <a class="reference external" href="http://genes.mit.edu/burgelab/miso/annotations/gene-models/Mus_musculus.NCBIM37.65.gff.zip">Mus_musculus.NCBIM37.65.gff</a>), we use <tt class="docutils literal"><span class="pre">exon_utils</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>exon_utils --get-const-exons Mus_musculus.NCBIM37.65.gff --min-exon-size 1000 --output-dir exons/
</pre></div>
</div>
<p>This will output a GFF file (named <tt class="docutils literal"><span class="pre">Mus_musculus.NCBIM37.65.min_1000.const_exons.gff</span></tt>) into the <tt class="docutils literal"><span class="pre">exons</span></tt> directory containing only constitutive exons that are at least 1000 bases long. This file can be used to compute the insert length distribution of all mouse RNA-Seq datasets. Exons here are defined as constitutive only if they occur in all annotated transcripts of a gene.</p>
<p><strong>Computing the insert length distribution given a constitutive exons file</strong>: Now that we have a file containing the long constitutive exons, we can compute the insert length for any BAM file using the <tt class="docutils literal"><span class="pre">pe_utils</span></tt> utilities. The option <tt class="docutils literal"><span class="pre">--compute-insert-len</span></tt> takes a BAM file with the RNA-Seq sample and a GFF file containing the long constitutive exons. The insert length is defined simply as the distance between the start coordinate of the first mate in the read pair and the end coordinate of the second mate in the read pair.</p>
<p>To compute the insert length for <tt class="docutils literal"><span class="pre">sample.bam</span></tt> using the constitutive exons file we made above, run:</p>
<div class="highlight-python"><div class="highlight"><pre>pe_utils --compute-insert-len sample.bam Mus_musculus.NCBIM37.65.min_1000.const_exons.gff --output-dir insert-dist/
</pre></div>
</div>
<p>This will efficiently map the BAM reads to the exons in the GFF file using <a class="reference external" href="http://code.google.com/p/bedtools/">bedtools</a>, and use the result to compute the insert lengths. The command requires the latest version of bedtools to be installed, where the <tt class="docutils literal"><span class="pre">tagBam</span></tt> utility was added the ability to output the interval that each read maps to in its BAM output file. The reads that aligned to these exons will be kept in a directory called <tt class="docutils literal"><span class="pre">bam2gff_Mus_musculus.NCBIM37.65.min_1000.const_exons.gff/</span></tt> in the <tt class="docutils literal"><span class="pre">insert-dist</span></tt> directory.</p>
<p>This will generate an insert length distribution file (ending in <tt class="docutils literal"><span class="pre">.insert_len</span></tt>) that is tab-delimited with two columns, the first specifying the exon that the read pairs were aligned to, and the second specifying a comma-separated list of insert lengths obtained from aligning the read pairs to that exon. The number of entries in the file corresponds to the number of exons from the original GFF that were used in computing the insert length distribution.</p>
<p>The first line (header) of the the insert length file gives the mean, standard deviation and dispersion values for the distribution, for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#mean=129.0,sdev=12.1,dispersion=1.1,num_pairs=862148</span>
</pre></div>
</div>
<p>This indicates that the mean of the insert length distribution was 129, the standard deviation was 12.1, dispersion was 1.1, and the number of read pairs used to estimate the distribution and compute these values was 862,148.</p>
<p>The dispersion constant <em>d</em> is defined as the standard deviation σ of the insert length distribution divided by the square root of its mean μ:</p>
<blockquote>
<div><div class="align-center figure">
<a class="reference internal image-reference" href="_images/dispersion.png"><img alt="Definition of dispersion constant for an insert length distribution" src="_images/dispersion.png" style="width: 92.8px; height: 38.4px;" /></a>
<p class="caption"><em>Dispersion constant d of an insert length distribution</em></p>
</div>
</div></blockquote>
<p>Intuitively, the dispersion constant <em>d</em> corresponds to how variable the insert length distribution is about its mean. The lower the <em>d</em> value is, the tighter/more precise the insert length distribution is in the RNA-Seq sample. The dispersion constant and an interpretation of its values is discussed in the MISO paper (see <a class="reference external" href="http://www.nature.com/nmeth/journal/v7/n12/full/nmeth.1528.html">Analysis and design of RNA sequencing experiments for identifying isoform regulation</a>).</p>
<p>The insert length distribution can be plotted using the <tt class="docutils literal"><span class="pre">.insert_len</span></tt> file using <a class="reference external" href="sashimi.html">sashimi_plot</a>.</p>
<p>To compute the insert length by simple pairing of read mates by their ID (assuming that mates belonging to a pair have the same read ID in the BAM), explicitly ignoring the relevant BAM fields specifying whether or not the reads are properly paired, use the <tt class="docutils literal"><span class="pre">--no-bam-filter</span></tt> option.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The option <tt class="docutils literal"><span class="pre">--compute-insert-len</span></tt> can take a comma-separated list of BAM filenames in case you want to compute the insert length for multiple samples in one command. The <tt class="docutils literal"><span class="pre">--compute-insert-len</span></tt> option of <tt class="docutils literal"><span class="pre">pe_utils</span></tt> by default uses only exons from the GFF file that are 500 bases or longer. This can be tweaked by passing <tt class="docutils literal"><span class="pre">pe_utils</span></tt> the optional <tt class="docutils literal"><span class="pre">--min-exon-size</span> <span class="pre">N</span></tt> argument, which will only use exons of size <tt class="docutils literal"><span class="pre">N</span></tt> or longer. In our example, we used a constitutive exons GFF file that contained only exons that are 100 bp or longer, so the default settings will consider all exons in that file.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="prefiltering-miso-events">
<h3>Prefiltering MISO events<a class="headerlink" href="#prefiltering-miso-events" title="Permalink to this headline">¶</a></h3>
<p>To increase efficiency, a prefiltering option was added in release <tt class="docutils literal"><span class="pre">0.4.7</span></tt>. When <tt class="docutils literal"><span class="pre">--prefilter</span></tt> is given to <tt class="docutils literal"><span class="pre">miso</span></tt>, MISO will calculate the number of reads in the input BAM mapping to each event in the input GFF. Events that do not meet the read coverage thresholds (as set in the configuration file) will be removed from the run. This feature requires the Bedtools utility <tt class="docutils literal"><span class="pre">tagBam</span></tt> to be installed and available on path. The call to <tt class="docutils literal"><span class="pre">tagBam</span></tt> introduces a startup cost per BAM file, but could in many cases save computation time, since events low coverage events will not processed or distributed as jobs to nodes when running on the cluster. From <tt class="docutils literal"><span class="pre">miso</span> <span class="pre">--help</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>--prefilter           Prefilter events based on coverage. If given as
                      argument, run will begin by mapping BAM reads to event
                      regions (using bedtools), and omit events that do not
                      meet coverage criteria from the run. By default,
                      turned off. Note that events that do not meet the
                      coverage criteria will not be processed regardless,
                      but --prefilter simply does this filtering step at the
                      start of the run, potentially saving computation time
                      so that low coverage events will not be processed or
                      distributed to jobs if MISO is run on a cluster. This
                      options requires bedtools to be installed and
                      available on path.
</pre></div>
</div>
</div>
<div class="section" id="distributing-miso-jobs-to-a-cluster">
<h3>Distributing MISO jobs to a cluster<a class="headerlink" href="#distributing-miso-jobs-to-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>Running MISO on a cluster is <strong>highly recommended</strong>. Since each gene or alternative splicing event
can be treated independently, the computation of expression levels is easily parallelized on a cluster.
This can reduce run times significantly, from days to hours on typical data sets. To run MISO on the
cluster, the following options can be used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">--use-cluster</span></tt>: causes jobs to be sent to a cluster</li>
<li><tt class="docutils literal"><span class="pre">--chunk-jobs</span> <span class="pre">N</span></tt> (optional): places <tt class="docutils literal"><span class="pre">N</span></tt> many genes or events into each job. For example, if running MISO on a set of skipped exons, <tt class="docutils literal"><span class="pre">--chunk-jobs</span> <span class="pre">200</span></tt> will place roughly 200 exons whose expression is to be estimated into each job. If each job was sent to a separate node, it would mean every node in parallel will sequentially compute the expression level of 200 exons. The value of <tt class="docutils literal"><span class="pre">--chunk-jobs</span></tt> depends on both cluster size/availability and on the number of exons whose expression is to be estimated. On very large clusters where nodes are generally available, a relatively small setting of <tt class="docutils literal"><span class="pre">--chunk-jobs</span></tt> is likely to be more efficient.</li>
<li><tt class="docutils literal"><span class="pre">--no-wait</span></tt> (optional): by default, the main process that submits the jobs to the cluster will wait for them to finish. If <tt class="docutils literal"><span class="pre">--no-wait</span></tt> is passed, the main process will not wait, and simply quit after submitting the jobs.</li>
</ul>
<p>MISO will use the cluster submission and queue settings described in the settings file to submit jobs (see <a class="reference internal" href="sashimi.html#config"><em>Visualizing RNA-Seq reads along isoforms with MISO estimates</em></a>). An example of a MISO pipeline for computing isoform expression estimates and detecting differentially expressed isoforms is given in <a class="reference internal" href="#pipeline"><em>Example MISO pipeline</em></a>.</p>
<p>To use MISO on Sun Grid Engine, the following options to <tt class="docutils literal"><span class="pre">miso</span></tt> can be used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">--SGEarray</span></tt>: Run jobs on Sun Grid Engine. To be used in conjunction with <tt class="docutils literal"><span class="pre">--use-cluster</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">--job-name</span></tt>: Name the job submitted to Sun Grid Engine system.</li>
</ul>
<p>Thanks to Michael Lovci for this feature.</p>
</div>
<div class="section" id="raw-miso-output-format">
<h3>Raw MISO output format<a class="headerlink" href="#raw-miso-output-format" title="Permalink to this headline">¶</a></h3>
<p>When running MISO, through <tt class="docutils literal"><span class="pre">miso</span> <span class="pre">--run</span></tt>, the raw output will be a set of posterior distributions over Ψ values. Each exon or gene, depending on whether the analysis is exon or isoform-centric, will have its own file containing posterior samples from the distribution over Ψ.</p>
<p>Most users will never need to access these raw distributions and can simply summarize this raw output as described in <a class="reference internal" href="#summarizing"><em>Summarizing MISO output</em></a>, or perform a comparison between a set of samples as described in <a class="reference internal" href="#comparing-samples"><em>Detecting differentially expressed isoforms</em></a>.</p>
<p>Each gene or exon will have a corresponding distribution file (ending in <tt class="docutils literal"><span class="pre">.miso</span></tt>), split into subdirectories by chromosome. The resulting directory structure might be:</p>
<div class="highlight-python"><div class="highlight"><pre>my_sample_output/
  chr1/
  chr2/
  ...
  chrX/
</pre></div>
</div>
<p>The distribution file for an event, e.g. <tt class="docutils literal"><span class="pre">chr1/my_exon.miso</span></tt>, will contain tab-separated columns that specify the sampled Ψ values and the log score under the MISO model for each sample, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre>#isoforms=[&#39;TandemUTRCore_TandemUTRExt&#39;,&#39;TandemUTRCore&#39;]      exon_lens=(&#39;TandemUTRCore&#39;,1986),(&#39;TandemUTRExt&#39;,1021)  iters=5000      burn_in=500     lag=10  percent_accept=92.90    proposal_type=drift
sampled_psi   log_score
0.0691,0.9309 -989.1296
0.0692,0.9308 -1002.1173
0.0595,0.9405 -994.5029
0.0587,0.9413 -988.9871
0.0539,0.9461 -980.4465
0.0571,0.9429 -986.1921
0.0482,0.9518 -980.2666
0.0392,0.9608 -999.4088
</pre></div>
</div>
<p>The header line (beginning with <tt class="docutils literal"><span class="pre">#</span></tt>) gives information about the gene/event in the file, like the names of the isoforms in the annotation and the length of the exons, as well as values of internal MISO parameters (like burn-in or lag, described in <a class="reference internal" href="sashimi.html#config"><em>Visualizing RNA-Seq reads along isoforms with MISO estimates</em></a>).</p>
<p>The first column (<tt class="docutils literal"><span class="pre">sampled_psi</span></tt>) lists the Ψ value sampled and the second column (<tt class="docutils literal"><span class="pre">log_score</span></tt>) gives the log score of that sample under the MISO model. The Ψ value is comma-separated and will have as many entries as there are isoforms. In the above file, there are two isoforms, and so two entries in the Ψ column that sum to 1.</p>
<p>After raw MISO output is summarized and all pairwise comparisons between samples have been made,
the raw output can be compressed (see <a class="reference internal" href="#compressing"><em>Compressing raw MISO output</em></a>.)</p>
</div>
</div>
</div>
<div class="section" id="summarizing-miso-output">
<span id="summarizing"></span><h1>Summarizing MISO output<a class="headerlink" href="#summarizing-miso-output" title="Permalink to this headline">¶</a></h1>
<p>To summarize MISO output and obtain confidence intervals (CIs) for Ψ values, the <tt class="docutils literal"><span class="pre">summarize_miso</span> <span class="pre">--summarize-samples</span></tt> option can be used:</p>
<div class="highlight-python"><div class="highlight"><pre>--summarize-samples
                       Compute summary statistics of the given set of
                       samples. Expects a directory with MISO output and
                       a directory to output summary file to.
</pre></div>
</div>
<p>For example, to summarize the MISO output in <tt class="docutils literal"><span class="pre">my_sample_output/</span></tt>, run:</p>
<div class="highlight-python"><div class="highlight"><pre>summarize_miso --summarize-samples my_sample_output/ summary_output/
</pre></div>
</div>
<p>This will create a subdirectory <tt class="docutils literal"><span class="pre">summary_output/summary/</span></tt> with a file <tt class="docutils literal"><span class="pre">my_sample_output.miso_summary</span></tt> that summarizes all the events in the sample in <tt class="docutils literal"><span class="pre">my_sample_output/</span></tt>.</p>
<div class="section" id="summary-file-output-format">
<span id="summary-format"></span><h2>Summary file output format<a class="headerlink" href="#summary-file-output-format" title="Permalink to this headline">¶</a></h2>
<p>The summary file is a tab-separated format containing the following columns:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">event_name</span></tt>: name of the event or gene from the input annotation,</li>
<li><tt class="docutils literal"><span class="pre">miso_posterior_mean</span></tt>: an estimate of Ψ (derived by taking the mean of the posterior distribution over Ψ),</li>
<li><tt class="docutils literal"><span class="pre">ci_low</span></tt>: the low bound of the 95% confidence interval on the Ψ estimate,</li>
<li><tt class="docutils literal"><span class="pre">ci_high</span></tt>: the high bound of the 95% confidence interval on the Ψ estimate.</li>
<li><tt class="docutils literal"><span class="pre">isoforms</span></tt>: the names of the isoforms that make up the event/gene
quantitated (from the input annotations)</li>
<li><tt class="docutils literal"><span class="pre">counts</span></tt>: raw read counts that support each isoform. Lists the number of reads that support each combination of isoforms. Each read type is represented as a comma-separated list (enclosed in parentheses) with number of entries equal to the number of isoforms quantitated, and a 1 or 0 in each entry depending on whether the read was consistent or inconsistent with the isoform. For example, for an alternative event with two isoforms, the entry might be: <tt class="docutils literal"><span class="pre">(1,0):28,(0,1):50,(1,1):12</span></tt>, where <tt class="docutils literal"><span class="pre">0</span></tt> and <tt class="docutils literal"><span class="pre">1</span></tt> correspond to the first and second isoforms. This indicates that 28 reads support isoform 1 but not 2, while 50 reads support the second but not the first, and 12 reads support both isoforms. The field <tt class="docutils literal"><span class="pre">(0,0):N</span></tt>, if outputted, indicates the number of reads <tt class="docutils literal"><span class="pre">N</span></tt> that mapped to the region but were thrown out (e.g. because they are not consistent with the isoforms in the annotation, violate overhang constraints, or other related reasons.)</li>
<li><tt class="docutils literal"><span class="pre">assigned_counts</span></tt>: inferred assignment of reads to isoforms. Lists each isoform (0-based) and the number of reads assigned to it. For example, for an alternative event with two isoforms, the entry might be: <tt class="docutils literal"><span class="pre">0:330,1:34</span></tt>, indicating that 330 reads were assigned to the first isoform (isoform 0) and 34 reads were assigned to the second isoform (isoform 1).</li>
</ul>
<p>Starting with release <tt class="docutils literal"><span class="pre">misopy-0.4.1</span></tt>, three additional columns are outputted with information about the gene/event (which are read from the input GFF annotation):</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">chrom</span></tt>: chromosome name</li>
<li><tt class="docutils literal"><span class="pre">strand</span></tt>: strand of gene/event</li>
<li><tt class="docutils literal"><span class="pre">mRNA_starts</span></tt>: comma-separated list of start genomic coordinates for <tt class="docutils literal"><span class="pre">mRNA</span></tt> entries in gene/event</li>
<li><tt class="docutils literal"><span class="pre">mRNA_ends</span></tt>: comma-separated list of end genomic coordinates for <tt class="docutils literal"><span class="pre">mRNA</span></tt> enries in gene/event</li>
</ul>
<p>When one of those fields is not available (e.g. <tt class="docutils literal"><span class="pre">strand</span></tt>), <tt class="docutils literal"><span class="pre">NA</span></tt> is outputted in its place.</p>
<p>Note that <tt class="docutils literal"><span class="pre">miso_posterior_mean</span></tt> is an estimate of Ψ and [<tt class="docutils literal"><span class="pre">ci_low</span></tt>, <tt class="docutils literal"><span class="pre">ci_high</span></tt>] are the 95% confidence limits of that estimate.</p>
</div>
</div>
<div class="section" id="detecting-differentially-expressed-isoforms">
<span id="comparing-samples"></span><h1>Detecting differentially expressed isoforms<a class="headerlink" href="#detecting-differentially-expressed-isoforms" title="Permalink to this headline">¶</a></h1>
<p>Once MISO output has been computed for two samples or more, pairwise comparison of differential
isoform expression can be computed. To test if an isoform or exon is differentially expressed between
between samples, the <em>Bayes factor</em> is computed for the exon, which represents the weight of the evidence
in the data in favor of differential expression versus not. For example, a Bayes factor of 2 would mean
that the isoform/exon is two times more likely to be differentially expressed than not.
The computation of Bayes factors is described in detail in Katz et. al. (2010).</p>
<p>To compute Bayes factors, the <tt class="docutils literal"><span class="pre">compare_miso</span> <span class="pre">--compare-samples</span></tt> option can be used. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>compare_miso --compare-samples control/ knockdown/ comparisons/
</pre></div>
</div>
<p>This would compare the MISO output in <tt class="docutils literal"><span class="pre">control/</span></tt> to <tt class="docutils literal"><span class="pre">knowndown/</span></tt>, and output the result
to the directory <tt class="docutils literal"><span class="pre">comparisons/control_vs_knockdown</span></tt>. Note that
&#8220;<tt class="docutils literal"><span class="pre">vs</span></tt>&#8221; is used to denote sample comparisons. The output format of
this comparison is described below.</p>
<div class="section" id="output-of-samples-comparison">
<h2>Output of samples comparison<a class="headerlink" href="#output-of-samples-comparison" title="Permalink to this headline">¶</a></h2>
<p>The main output of <tt class="docutils literal"><span class="pre">--compare-samples</span></tt> will be in:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">bayes-factors/</span></tt>: contains the file summarizing the output with the Bayes factors (ending in <tt class="docutils literal"><span class="pre">.miso_bf</span></tt>)</li>
</ul>
<div class="section" id="bayes-factors-file-output-format">
<span id="bf-output"></span><h3>Bayes factors file output format<a class="headerlink" href="#bayes-factors-file-output-format" title="Permalink to this headline">¶</a></h3>
<p>The Bayes factors file (ending in <tt class="docutils literal"><span class="pre">.miso_bf</span></tt>) will be stored in the <tt class="docutils literal"><span class="pre">bayes-factors/</span></tt> directory generated
by the <tt class="docutils literal"><span class="pre">--compare-samples</span></tt> option. The Bayes factor file is a tab-separated format containing the following columns:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">event_name</span></tt>: name of the event from the input annotation file,</li>
<li><tt class="docutils literal"><span class="pre">sample1_posterior_mean</span></tt>: Estimate of Ψ (mean of posterior distribution) for sample 1,</li>
<li><tt class="docutils literal"><span class="pre">sample1_ci_low</span></tt>: Low bound of 95% confidence interval for sample 1 Ψ estimate,</li>
<li><tt class="docutils literal"><span class="pre">sample1_ci_high</span></tt>: High bound of the 95% confidence interval for sample 1 Ψ estimate,</li>
<li><tt class="docutils literal"><span class="pre">sample2_posterior_mean</span></tt>: Estimate of Ψ (mean of posterior distribution) for sample 2,</li>
<li><tt class="docutils literal"><span class="pre">sample2_ci_low</span></tt>: Low bound of 95% confidence interval for sample 2 Ψ estimate,</li>
<li><tt class="docutils literal"><span class="pre">sample2_ci_high</span></tt>: High bound of 95% confidence interval for sample 2 Ψ estimate,</li>
<li><tt class="docutils literal"><span class="pre">diff</span></tt>: The difference (Δ Ψ) between sample 1 and sample 2 Ψ estimates, i.e. <tt class="docutils literal"><span class="pre">sample1_posterior_mean</span> <span class="pre">-</span> <span class="pre">sample2_posterior_mean</span></tt></li>
<li><tt class="docutils literal"><span class="pre">bayes_factor</span></tt>: Bayes factor for the comparison, corresponding to the odds of differential expression ,where the change in Ψ is non-zero) over no differential expression (where the change is zero),</li>
<li><tt class="docutils literal"><span class="pre">isoforms</span></tt>: the names of the transcripts or events that were quantitated (based on the input annotation),</li>
<li><tt class="docutils literal"><span class="pre">sample1_counts</span></tt>: raw counts for sample 1 for each read type (same format as the <tt class="docutils literal"><span class="pre">counts</span></tt> field described in <a class="reference internal" href="#summary-format"><em>Summary file output format</em></a>),</li>
<li><tt class="docutils literal"><span class="pre">sample1_assigned_counts</span></tt>: inferred assignment of reads to isoforms in sample 1 (same format as the <tt class="docutils literal"><span class="pre">assigned_counts</span></tt> field described in <a class="reference internal" href="#summary-format"><em>Summary file output format</em></a>),</li>
<li><tt class="docutils literal"><span class="pre">sample2_counts</span></tt>: raw counts for sample 2 for each read type,</li>
<li><tt class="docutils literal"><span class="pre">sample2_assigned_counts</span></tt>: inferred assignment of reads to isoforms in sample 2</li>
</ul>
<p>If MISO is run on an annotation that specifies more than two isoforms per event/gene, then the fields for the Ψ estimates become comma-separated and give the estimates for each isoform. For example, in the case of three isoforms, <tt class="docutils literal"><span class="pre">sample1_ci_low</span></tt> would be a comma-separated list of the lower bounds of the first, second and third isoform, and <tt class="docutils literal"><span class="pre">sample1_ci_high</span></tt> would be a comma-separated list of the upper bounds of the first, second and third isoform, and similarly for the fields involving the other sample.</p>
<p>Starting with release <tt class="docutils literal"><span class="pre">misopy-0.4.1</span></tt>, three additional columns are outputted with information about the gene/event (which are read from the input GFF annotation):</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">chrom</span></tt>: chromosome name</li>
<li><tt class="docutils literal"><span class="pre">strand</span></tt>: strand of gene/event</li>
<li><tt class="docutils literal"><span class="pre">mRNA_starts</span></tt>: comma-separated list of start genomic coordinates for <tt class="docutils literal"><span class="pre">mRNA</span></tt> entries in gene/event</li>
<li><tt class="docutils literal"><span class="pre">mRNA_ends</span></tt>: comma-separated list of end genomic coordinates for <tt class="docutils literal"><span class="pre">mRNA</span></tt> enries in gene/event</li>
</ul>
<p>When one of those fields is not available (e.g. <tt class="docutils literal"><span class="pre">strand</span></tt>), <tt class="docutils literal"><span class="pre">NA</span></tt> is outputted in its place.</p>
</div>
</div>
</div>
<div class="section" id="compressing-raw-miso-output">
<span id="compressing"></span><h1>Compressing raw MISO output<a class="headerlink" href="#compressing-raw-miso-output" title="Permalink to this headline">¶</a></h1>
<div class="section" id="packing-miso-output">
<h2>Packing MISO output<a class="headerlink" href="#packing-miso-output" title="Permalink to this headline">¶</a></h2>
<p>Starting from version 0.5.0, the <tt class="docutils literal"><span class="pre">miso_pack</span></tt> utility is available for <em>packing</em> raw MISO output. The packing utility converts the raw MISO output directories that contain <tt class="docutils literal"><span class="pre">*.miso</span></tt> files and converts them into a portable <a class="reference external" href="http://www.sqlite.org/">SQLite database</a> (one database file per chromosome.) This reduces the number of files substantially, which otherwise could burden the filesystem. The packing operation uses the built-in SQL library of Python (<tt class="docutils literal"><span class="pre">sqlite3</span></tt>) and does not require installation of any external SQL databases.</p>
<p>All downstream analyses analyses (like sample summary and comparisons, as described in <a class="reference internal" href="#summarizing"><em>Summarizing MISO output</em></a> and <a class="reference internal" href="#comparing-samples"><em>Detecting differentially expressed isoforms</em></a>) work with the packed format, and so there is never a need to &#8216;unpack&#8217; MISO output once <tt class="docutils literal"><span class="pre">miso_pack</span></tt> was run. To pack a directory <tt class="docutils literal"><span class="pre">miso_output/</span></tt> that contains output from MISO, run:</p>
<div class="highlight-python"><div class="highlight"><pre>miso_pack --pack miso_output/
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">miso_pack</span></tt> utility will traverse the entire directory structure of <tt class="docutils literal"><span class="pre">miso_output</span></tt> and pack any directories that contain raw MISO output.</p>
<p><em>Note:</em> The SQLite databases made by <tt class="docutils literal"><span class="pre">miso_pack</span></tt> can be read independently of Python and queries as ordinary SQLite databases. However, end-users should never need to deal with these files directly.</p>
</div>
<div class="section" id="long-term-archival-and-compression-of-miso-output">
<h2>Long-term archival and compression of MISO output<a class="headerlink" href="#long-term-archival-and-compression-of-miso-output" title="Permalink to this headline">¶</a></h2>
<p>Once all the samples have been summarized and all pairwise comparisons between samples have been made (as described in <a class="reference internal" href="#summarizing"><em>Summarizing MISO output</em></a> and <a class="reference internal" href="#comparing-samples"><em>Detecting differentially expressed isoforms</em></a>), space can be saved by archiving the MISO output for long-term storage.</p>
<p>To compress directories containing raw MISO output files, a utility called <tt class="docutils literal"><span class="pre">miso_zip</span></tt> can be used. For example, to compress the directory <tt class="docutils literal"><span class="pre">miso_output/</span></tt> into and name the result <tt class="docutils literal"><span class="pre">mydata.misozip</span></tt>, use:</p>
<div class="highlight-python"><div class="highlight"><pre>miso_zip --compress mydata.misozip miso_output/
</pre></div>
</div>
<p>(Note that compressed MISO files must end in <tt class="docutils literal"><span class="pre">.misozip</span></tt>.) If <tt class="docutils literal"><span class="pre">miso_output</span></tt> is not already packed, <tt class="docutils literal"><span class="pre">miso_zip</span></tt> will first pack it, and then compress the result using standard <tt class="docutils literal"><span class="pre">zip</span></tt> comrpession to save space. <tt class="docutils literal"><span class="pre">miso_zip</span></tt> will take as argument any directory containing <tt class="docutils literal"><span class="pre">*.miso</span></tt> files (either directory within it or within its subdirectories)</p>
<p>This compression reduces the number of files dramatically, since each sample gets one SQLite database per chromosome. The resulting directory structure is then compressed further using standard <tt class="docutils literal"><span class="pre">zip</span></tt> compression into a single zip file (in this case named <tt class="docutils literal"><span class="pre">mydata.zip</span></tt>).</p>
<p>The compressed <tt class="docutils literal"><span class="pre">.misozip</span></tt> files can be uncompressed using <tt class="docutils literal"><span class="pre">miso_zip</span></tt> as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>miso_zip --uncompress mydata.misozip uncompressed/
</pre></div>
</div>
<p>This will uncompress <tt class="docutils literal"><span class="pre">mydata.misozip</span></tt> and output its contents into the directory <tt class="docutils literal"><span class="pre">uncompressed/</span></tt>.</p>
<p><em>Note:</em> <tt class="docutils literal"><span class="pre">miso_zip</span></tt> will <em>not</em> delete the directory being compressed. The directory can be deleted manually after compression is done.</p>
</div>
</div>
<div class="section" id="example-miso-pipeline">
<span id="pipeline"></span><h1>Example MISO pipeline<a class="headerlink" href="#example-miso-pipeline" title="Permalink to this headline">¶</a></h1>
<p>Below is an example of a MISO pipeline, where Ψ values for a set of alternative events are computed (with confidence intervals) for a pair of samples called &#8220;control&#8221; and &#8220;knockdown&#8221;. A samples comparison is performed to detect differentially expressed isoforms between the samples.</p>
<div class="highlight-python"><div class="highlight"><pre>## Run MISO on a pair of paired-end sample (with insert length distribution with mean 250,
## standard deviation 15) using the mouse genome skipped exon annotations using the
## the cluster

# Compute Psi values for control sample
miso --run mm9/pickled/SE data/control.bam --output-dir SE/control/ --read-len 35 --paired-end 250 15 --use-cluster

# Compute Psi values for knockdown sample
miso --run mm9/pickled/SE data/knockdown.bam --output-dir SE/knockdown/ --read-len 35 --paired-end 250 15 --use-cluster


## Summarize the output (only run this once --run finished!)
## This will create a &quot;summary&quot; directory in SE/control/ and in SE/knockdown/
summarize_miso --summarize-samples SE/control/ SE/control/
summarize_miso --summarize-samples SE/knockdown/ SE/knockdown/

## Detect differentially expressed isoforms between &quot;control&quot; and &quot;knockdown&quot;
## This will compute Bayes factors and delta Psi values between the samples
## and place the results in the directory SE/comparisons/control_vs_knockdown
compare_miso --compare-samples SE/control/ SE/knockdown/ SE/comparisons/
</pre></div>
</div>
</div>
<div class="section" id="interpreting-and-filtering-miso-output">
<span id="interpreting"></span><h1>Interpreting and filtering MISO output<a class="headerlink" href="#interpreting-and-filtering-miso-output" title="Permalink to this headline">¶</a></h1>
<p>Once MISO runs are completed and pairwise comparisons between your samples have been made to compute Bayes factors (using <tt class="docutils literal"><span class="pre">--compare-samples</span></tt>), the resulting files can be interpreted to detect differential events.  For each pairwise comparison, we will have a <tt class="docutils literal"><span class="pre">.miso_bf</span></tt> file which contains the Ψ values of each event in both samples along with confidence intervals (assuming the event is detectable in both), the Δ Ψ values, the Bayes factor, and other useful information about the read counts used to compute these values.</p>
<p>MISO comes with several utilities (such as <tt class="docutils literal"><span class="pre">filter_events</span></tt>, described in <a class="reference internal" href="#filterscript"><em>Filtering differentially expressed events</em></a>) for helping with the interpretation and analysis of these output files. This section serves as a brief guide the MISO output files, the utilities for analyzing them, and to various caveats in interpreting the output.</p>
<div class="section" id="using-the-read-class-counts">
<span id="usingcounts"></span><h2>Using the read class counts<a class="headerlink" href="#using-the-read-class-counts" title="Permalink to this headline">¶</a></h2>
<p>A first-pass filter for detecting differentially changing events can apply a Bayes factor cutoff along with a Δ Ψ cutoff, using the <tt class="docutils literal"><span class="pre">bayes_factor</span></tt> and <tt class="docutils literal"><span class="pre">diff</span></tt> fields of the samples comparison output file. Section <a class="reference internal" href="#filterscript"><em>Filtering differentially expressed events</em></a> describes a utility that will apply these filters for exon-centric analyses.</p>
<p>It is critical to note that the default MISO settings were intentionally set to be highly inclusive, and therefore do not impose any stringent coverage criteria on the events for which Ψ values and Bayes factors are computed.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By default, MISO requires only 20 reads to be present in the locus/event of interest. For many events, only a tiny fraction of these reads might be in informative regions &#8211; like junctions or regions unique to one of the isoforms &#8211; and so the expression levels of these events might not be reliably estimated. It is important to use the information provided by MISO about the raw number of read counts used in estimating the expression levels of each event/gene.</p>
</div>
</div></blockquote>
<p>In addition to Ψ values, confidence intervals and Bayes factors, the output files of MISO (such as summary files or sample comparison files) also contain the number of read counts informative about each isoform.
The relevant read counts are given in the <tt class="docutils literal"><span class="pre">counts</span></tt> field of the <tt class="docutils literal"><span class="pre">.miso,</span> <span class="pre">.summary,</span> <span class="pre">.miso_bf</span></tt> files &#8211; its format is described in detail in <a class="reference internal" href="#summary-format"><em>Summary file output format</em></a>). For the two-isoform case in exon-centric analyses, the counts field general format is:</p>
<div class="highlight-python"><div class="highlight"><pre>(1,0):X,(0,1):Y,(1,1):Z,(0,0):L
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">X,</span> <span class="pre">Y,</span> <span class="pre">Z,</span> <span class="pre">L</span></tt> are integer counts corresponding to the number of reads in each of these categories. Class <tt class="docutils literal"><span class="pre">(1,0)</span></tt> are reads consistent with the first isoform in the annotation but not the second, class <tt class="docutils literal"><span class="pre">(0,1)</span></tt> are reads consistent with the second but not the first, class <tt class="docutils literal"><span class="pre">(1,1)</span></tt> are consistent with both isoforms, and reads in <tt class="docutils literal"><span class="pre">(0,0)</span></tt> are consistent with neither. These are illustrated graphically in the figure below for alternatively skipped exon event:</p>
<blockquote>
<div><div class="align-center figure">
<a class="reference internal image-reference" href="_images/read_classes_for_SE.png"><img alt="Illustration of MISO read class counts for a skipped exon" src="_images/read_classes_for_SE.png" style="width: 320.0px; height: 292.0px;" /></a>
<p class="caption"><em>Illustration of MISO output read class counts for a skipped exon</em></p>
</div>
</div></blockquote>
<p>The class <tt class="docutils literal"><span class="pre">(0,0)</span></tt> denotes reads that were incompatible with either isoform, either because they didn&#8217;t match these isoforms or were otherwise unusable (e.g. they were part of a read-pair where one end was unmappable, in the case of paired-end reads.) Reads in this class are not used by MISO &#8211; they are only reported to indicate that they were discarded.</p>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Events that meet the very minimal default coverage criteria do not necessarily have sufficient read support to be considered alternatively spliced in your RNA-Seq samples.</p>
</div>
</div></blockquote>
<p>In practice, events that might not be alternatively spliced in the samples of interest meet the default minimal read coverage criteria, although their read class counts imply that they are not reliable estimates. Such a case might be an alternative exon in the input annotation to MISO that has, for example, 19 reads in the exon upstream of the skipped exon, and 1 read in the exon downstream of the skipped exon. This event would have a <tt class="docutils literal"><span class="pre">counts</span></tt> signature of: <tt class="docutils literal"><span class="pre">(1,1):20,(1,0):0,(0,1):0</span></tt>. The <tt class="docutils literal"><span class="pre">(1,0)</span></tt> and <tt class="docutils literal"><span class="pre">(0,1)</span></tt> reads, which are most informative about the relative inclusion levels of the exon, are both 0, so unless these are non-zero in other samples in the dataset, the estimate of the inclusion levels of this exon will not be reliable.</p>
<p>For this reason, <strong>coverage filters</strong> must be imposed by the user when post-processing MISO output. An example of such a filter is given below for exon-centric analyses.</p>
<blockquote>
<div><div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>A commonly-used <strong>coverage filter</strong> in exon-centric (two-isoform) analyses requires the following minimal counts criteria to be met:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">X</span> <span class="o">+</span> <span class="n">Y</span> <span class="o">&gt;=</span> <span class="n">N</span><span class="p">,</span> <span class="n">Y</span> <span class="o">&gt;=</span> <span class="mi">1</span>
</pre></div>
</div>
<p class="last">in <em>at least one</em> of the RNA-Seq samples processed by MISO, where <tt class="docutils literal"><span class="pre">X,</span> <span class="pre">Y</span></tt> are the number of reads in the <tt class="docutils literal"><span class="pre">(1,0)</span></tt> and <tt class="docutils literal"><span class="pre">(0,1)</span></tt> read classes, respectively, and <tt class="docutils literal"><span class="pre">N</span></tt> is an arbitrary but sizeable number (e.g. 10 or 20). This filter requires that the sum of inclusion and exclusion-supporting reads be greater than or equal to <tt class="docutils literal"><span class="pre">N</span></tt>, and that the read class supporting exclusion is non-zero in at least one of the samples. This guarantees that at least some of the reads are informative about the inclusive or exclusive isoform. Note that this filter does not guarantee that there will be junction evidence for the inclusion isoform, but does guarantee that there will be a junction evidence for skipping of the exon.</p>
</div>
</div></blockquote>
<p>To increase power to detect differential events, coverage filters should be applied in aggregate across all RNA-Seq samples that were processed by MISO. To detect <em>switch-like</em> exons that are fully included in one sample and fully excluded in another, we should require the number of exon exclusion supporting reads be non-zero in at least one of the samples &#8211; or summed across samples &#8211; rather than in every sample. This filter can be easily applied by parsing the <tt class="docutils literal"><span class="pre">counts</span></tt> field in the samples comparison (<tt class="docutils literal"><span class="pre">.miso_bf</span></tt>) file produced by MISO for each pairwise comparison.</p>
<p>For isoform-centric analyses where the number of read classes is considerably larger, MISO will output the counts in the same format. For a gene with 3 isoforms, we can have the read classes <tt class="docutils literal"><span class="pre">(1,0,0),(0,1,0),(0,0,1),...,(1,1,1)</span></tt> and other filters can be applied, depending on the goal of the analysis, to select genes that have sufficient coverage to be reliably estimated.</p>
</div>
<div class="section" id="using-the-confidence-intervals">
<span id="confidence-intervals"></span><h2>Using the confidence intervals<a class="headerlink" href="#using-the-confidence-intervals" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><div class="align-right figure">
<a class="reference internal image-reference" href="_images/confidence_intervals.png"><img alt="MISO confidence intervals" src="_images/confidence_intervals.png" style="width: 165.2px; height: 213.5px;" /></a>
</div>
</div></blockquote>
<p>Important information is contained in the confidence intervals outputted by MISO for each estimate of Ψ. The width of the interval corresponds to our confidence in the estimate of the Ψ value, and so the larger the confidence width is, the less reliable the estimate. As expected, the width of the confidence interval will depend on the number of informative reads, such as reads crossing junctions or reads in regions that uniquely identify the isoform.</p>
<p>The figure on the right shows two posterior distributions over Ψ for the same alternative splicing event in two samples, where the exon had low coverage (i.e. small number of reads) in both. The posterior distribution is plotted as a black histogram, whose mean is indicated by the red vertical line and 95% confidence intervals shown by dotted grey vertical lines. The actual Ψ values and the confidence interval bounds are given to the right of the distribution. In the top distribution, the confidence interval width is <tt class="docutils literal"><span class="pre">.64</span></tt> (since <tt class="docutils literal"><span class="pre">.88</span> <span class="pre">-</span> <span class="pre">.24</span> <span class="pre">=</span> <span class="pre">.64</span></tt>) which is extremely wide. The distribution&#8217;s probable range spans from 20 to nearly 90%, far too broad to be useful. In the bottom distribution, the confidence intervals are narrower, though still considerable. Because of the large amount of uncertainty in the top distribution, we cannot confidently conclude that the true Ψ value is likely to be different between the two. Although the difference of means between the distributions is large (<tt class="docutils literal"><span class="pre">.53</span> <span class="pre">-</span> <span class="pre">.2</span> <span class="pre">=</span> <span class="pre">.33</span></tt>), the confidence intervals overlap considerably as a result of the uncertainty in the top distribution. In practice, requiring no overlap at all between the confidence intervals of two samples is too restrictive, but the width of each estimate&#8217;s confidence interval and the relationship between the intervals should be kept in mind when interpreting the results.</p>
</div>
<div class="section" id="filtering-differentially-expressed-events">
<span id="filterscript"></span><h2>Filtering differentially expressed events<a class="headerlink" href="#filtering-differentially-expressed-events" title="Permalink to this headline">¶</a></h2>
<p>Given a MISO Bayes factor comparison file for two-isoform events, events can be filtered based on their coverage or magnitude of change. The <tt class="docutils literal"><span class="pre">filter_events</span></tt> script allows filtering of events, based on the following criteria:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">--num-total</span> <span class="pre">N</span></tt>: Number of total reads aligning to any isoform (or to both isoforms) has to be greater than or equal to N.</li>
<li><tt class="docutils literal"><span class="pre">--num-inc</span> <span class="pre">N</span></tt>: Number of inclusion reads (i.e. reads supporting the first isoform) has to be greater than or equal to N.</li>
<li><tt class="docutils literal"><span class="pre">--num-exc</span> <span class="pre">N</span></tt>: Number of exclusion reads (i.e. reads supporting the second isoform) has to be greater than or equal to N.</li>
<li><tt class="docutils literal"><span class="pre">--num-sum-inc-exc</span> <span class="pre">N</span></tt>: The sum of inclusion and exclusion reads has to be greater than or equal to N.</li>
<li><tt class="docutils literal"><span class="pre">--delta-psi</span> <span class="pre">P</span></tt>: The absolute Δ Ψ value must be greater than or equal to P (where P is in [0, 1]).</li>
<li><tt class="docutils literal"><span class="pre">--bayes-factor</span> <span class="pre">N</span></tt>: The Bayes factor must be greater than or equal to N.</li>
<li><tt class="docutils literal"><span class="pre">--apply-both</span></tt>: By default, the above filters on read coverage of the isoforms are required to be true in only one of the samples. To consider only events where the filters apply in both samples, use this option.</li>
</ul>
<p>For example, to filter the file <tt class="docutils literal"><span class="pre">control.miso_bf</span></tt> to contain only events with: (a) at least 1 inclusion read, (b) 1 exclusion read, such that (c) the sum of inclusion and exclusion reads is at least 10, and (d) the Δ Ψ is at least 0.20 and (e) the Bayes factor is at least 10, and (a)-(e) are true in one of the samples, use the following command:</p>
<div class="highlight-python"><div class="highlight"><pre>filter_events --filter control.miso_bf --num-inc 1 --num-exc 1 --num-sum-inc-exc 10 --delta-psi 0.20 --bayes-factor 10 --output-dir filtered/
</pre></div>
</div>
<p>This will output a filtered Bayes factor file, <tt class="docutils literal"><span class="pre">filtered/control.miso_bf.filtered</span></tt> that contains only events meeting the above criteria.</p>
</div>
</div>
<div class="section" id="visualizing-and-plotting-miso-output">
<span id="plotting"></span><h1>Visualizing and plotting MISO output<a class="headerlink" href="#visualizing-and-plotting-miso-output" title="Permalink to this headline">¶</a></h1>
<p>MISO comes with a built-in utility, <a class="reference external" href="sashimi.html">sashimi_plot</a>, for visualizing its output and for plotting raw RNA-Seq read densities along exons and junctions.</p>
</div>
<div class="section" id="updates">
<h1>Updates<a class="headerlink" href="#updates" title="Permalink to this headline">¶</a></h1>
<p><strong>2014</strong></p>
<ul class="simple">
<li><strong>Tue, Mar 11</strong>: Released <tt class="docutils literal"><span class="pre">0.5.2</span></tt>, which fixes an error reporting bug. Thanks to John Tobias and Sabine Dietmann.</li>
<li><strong>Sun, Feb 23</strong>: Fixed Sashimi plot bug.</li>
<li><strong>Fri, Feb 21</strong>: Fixed critical bug in <tt class="docutils literal"><span class="pre">miso_pack</span></tt> handling of Ensembl chromosomes in <tt class="docutils literal"><span class="pre">0.5.0</span></tt> release. Please update your release.</li>
<li><strong>Thu, Feb 20</strong>: Released <tt class="docutils literal"><span class="pre">0.5.0</span></tt>.<ul>
<li>Renamed scripts: The core MISO scripts are now named <tt class="docutils literal"><span class="pre">miso</span></tt>, <tt class="docutils literal"><span class="pre">summarize_miso</span></tt> and <tt class="docutils literal"><span class="pre">compare_miso</span></tt>. Python extensions (<tt class="docutils literal"><span class="pre">.py</span></tt>) have been dropped. Entry points are used in Python installations to resolve issues with scripts not being registered as executables after installation.</li>
<li>Added <tt class="docutils literal"><span class="pre">--no-wait</span></tt> option to <tt class="docutils literal"><span class="pre">miso</span></tt> to prevent main process from waiting on cluster jobs</li>
<li>Fixed bug that prevented <tt class="docutils literal"><span class="pre">--apply-both</span></tt> from working in <tt class="docutils literal"><span class="pre">filter_events</span></tt></li>
</ul>
</li>
</ul>
<p><strong>2013</strong></p>
<ul class="simple">
<li><strong>Jun 26</strong>: Fixed formatting error for version 1 ALE events. Reorganized documentation.</li>
<li><strong>Apr 26</strong>: Released version <tt class="docutils literal"><span class="pre">0.4.9</span></tt>. Contains Sashimi plot-related bug fixes.</li>
<li><strong>Apr 14</strong>: Released version <tt class="docutils literal"><span class="pre">0.4.8</span></tt>. Includes several important bug fixes and a new much faster version of the inference algorithm for single-end reads:<ul>
<li>New, much faster inference scheme for single-end reads (implemented by Gabor Csardi)</li>
<li>Fixed bug in parsing of Ensembl style chromosomes</li>
<li>Fixed bug in <tt class="docutils literal"><span class="pre">--prefilter</span></tt> option. Added <tt class="docutils literal"><span class="pre">-p</span></tt> option to <tt class="docutils literal"><span class="pre">run_events_analysis.py</span></tt> for determining the number of processors to be used.</li>
<li>Fixed potential deadlock situation when running locally on machines with multiple cores.</li>
<li>Added <tt class="docutils literal"><span class="pre">miso_zip</span></tt> utility for compressing/uncompressing MISO output.</li>
<li>Better error checking for incompatibilities between BAM and GFF files, e.g. cases where the chromosome naming conventions between the annotation and the BAM differ.</li>
<li>Fixed entries in hg19 alternative event annotations where start &gt; end.</li>
<li>Changed default MISO settings file to omit queue names from cluster submissions.</li>
</ul>
</li>
<li><strong>Tue, Jan 1</strong>: Released version <tt class="docutils literal"><span class="pre">0.4.7</span></tt>. Includes several new features, including:<ul>
<li>Support for strand-specific reads</li>
<li>Support for running MISO locally using multi-cores</li>
<li>Prefilter feature: prefilter events with low coverage on long runs (requires Bedtools)</li>
</ul>
</li>
</ul>
<p>See also <a class="reference external" href="updates.html">all release updates</a> (including older releases).</p>
</div>
<div class="section" id="frequently-asked-questions-faq">
<span id="faq"></span><h1>Frequently Asked Questions (FAQ)<a class="headerlink" href="#frequently-asked-questions-faq" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><strong>How can I convert my GTF file into a GFF3 format that MISO accepts?</strong> (<a class="reference external" href="#answer1">answer</a>)</li>
<li><strong>When filtering events from a Bayes factor comparison file, I get the error &#8220;Exception: Malformed comparison line.&#8221;</strong> (<a class="reference external" href="#answer2">answer</a>)</li>
<li><strong>When trying to run MISO on a pickled annotation, I get the error &#8220;ValueError: can&#8217;t handle version -1 of numpy.dtype pickle.&#8221;</strong> (<a class="reference external" href="#answer3">answer</a>)</li>
<li><strong>When I run MISO on my BAM file, it finds that 0 reads align to all events!</strong> (<a class="reference external" href="#answer4">answer</a>)</li>
<li><strong>When I run MISO on my BAM file, it finds far too few reads aligning to the events (but not 0)!</strong> (<a class="reference external" href="#answer5">answer</a>)</li>
<li><strong>I am making my own GFF annotation file of alternative events for use with MISO. How should I format the</strong> <tt class="docutils literal"><span class="pre">ID</span></tt> <strong>value of GFF entries?</strong> (<a class="reference external" href="#answer6">answer</a>)</li>
<li><strong>Are there different MISO versions? Which should I use?</strong> (<a class="reference external" href="#answer7">answer</a>)</li>
<li><strong>Where can I download MISO?</strong> (<a class="reference external" href="#answer8">answer</a>)</li>
<li><strong>How can I map MISO alternative event annotations to the genes they are in?</strong> (<a class="reference external" href="#answer9">answer</a>)</li>
<li><strong>Can I use MISO with my own custom annotations of alternative events? Or my own annotation of genes from their mRNA isoforms that I obtained from Ensembl/UCSC/Refseq?</strong> (<a class="reference external" href="#answer10">answer</a>)</li>
<li><strong>What is the input to the</strong> <tt class="docutils literal"><span class="pre">--compare-samples</span></tt> <strong>option? Do I have to generate a summary file before using it?</strong> (<a class="reference external" href="#answer11">answer</a>)</li>
<li><strong>I ran MISO on genes/events that have 2 isoforms, but the output summary files and comparison files contain just a single number for</strong> Ψ <strong>for each entry. Shouldn&#8217;t there be 2 numbers, one for each isoform?</strong> (<a class="reference external" href="#answer12">answer</a>)</li>
<li><strong>How does MISO deal with replicates?</strong> (<a class="reference external" href="#answer13">answer</a>)</li>
<li><strong>Is there a mapping from events to genes for hg19?</strong>  (<a class="reference external" href="#answer14">answer</a>)</li>
<li><strong>If I am running MISO with a GFF annotation containing multiple isoforms, how do I know which isoform each |Psi| value in the vector corresponds to?</strong> (<a class="reference external" href="#answer15">answer</a>)</li>
<li><strong>When using</strong> <tt class="docutils literal"><span class="pre">pe_utils</span></tt> <strong>to compute the paired-end insert length distribution, I get the error</strong> <tt class="docutils literal"><span class="pre">[main_samview]</span> <span class="pre">truncated</span> <span class="pre">file</span></tt> <strong>and/or a segmentation fault.</strong> (<a class="reference external" href="#answer16">answer</a>)</li>
<li><strong>When I try to index GFF files using</strong> <tt class="docutils literal"><span class="pre">index_gff</span></tt> <strong>I get a segmentation fault.</strong> (<a class="reference external" href="#answer17">answer</a>)</li>
<li><strong>I am having trouble installing scipy/numpy/matplotlib. How can I install them?</strong> (<a class="reference external" href="#answer18">answer</a>)</li>
<li><strong>When should I use paired-end mode versus single-end mode?</strong> (<a class="reference external" href="#answer19">answer</a>)</li>
<li><strong>What is the license for MISO?</strong> (<a class="reference external" href="#answer20">answer</a>)</li>
</ol>
<div class="section" id="answers">
<h2>Answers<a class="headerlink" href="#answers" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple" id="answer1">
<li><strong>How can I convert my GTF file into a GFF3 format that MISO accepts? Thanks to Ross Lazarus for the answer:</strong> GTF files of gene models can be converted using SequenceOntology&#8217;s <a class="reference external" href="http://www.sequenceontology.org/resources/converter_readme.html">GTF2GFF</a> converter (or using this posted <a class="reference external" href="http://seqanswers.com/forums/showthread.php?t=3201&amp;highlight=GFF3">Perl script</a>) to GFF3 format. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer2" start="2">
<li><strong>When filtering events from a Bayes factor comparison file, I get the error &#8220;Exception: Malformed comparison line.&#8221;</strong> This error arises when using the options to filter on number of inclusion/exclusion reads (or the sum of these) on a comparison file that contains events with more than two isoforms. &#8220;Inclusion&#8221; and &#8220;exclusion&#8221; reads are only defined when the event has two isoforms, where MISO by convention considers the first isoform in the annotation to be the inclusive one, and the second to be the exclusive. Events with three or more isoforms cannot be filtered using these options. In the general case of arbitrarily many isoforms (e.g. some 2 and some more than 2), <tt class="docutils literal"><span class="pre">filter_events.py</span></tt> can be used but then the only valid options are <tt class="docutils literal"><span class="pre">--bayes-factor</span></tt> or <tt class="docutils literal"><span class="pre">--delta-psi</span></tt> to filter on Bayes factor and/or magnitude of change in Ψ, which are defined in all cases. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer3" start="3">
<li><strong>When trying to run MISO on a pickled annotation, I get the error &#8220;ValueError: can&#8217;t handle version -1 of numpy.dtype pickle.&#8221;</strong> This probably means that you are using an older version of numpy. The solution is to use version 1.4 or higher, see Brad Friedman&#8217;s note (<a class="reference external" href="http://blog.friedman-lab.com/2011/01/11/running-miso-on-a-cluster/">http://blog.friedman-lab.com/2011/01/11/running-miso-on-a-cluster/</a>).  Thanks to Brad Friedman and Marvin Jens. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer4" start="4">
<li><strong>When I run MISO on my BAM file, it finds that 0 reads align to all events!</strong> This problem is most commonly caused by one of the following issues:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>MISO is passed a BAM file that is not sorted and indexed. BAM files must be sorted and indexed to allow MISO random access to regions in the BAM.</li>
<li>The BAM file was indexed, but the <tt class="docutils literal"><span class="pre">.bai</span></tt> file (which holds the index) is not present in the same directory as the <tt class="docutils literal"><span class="pre">.bam</span></tt> file passed to MISO. Indexing the file and ensuring that its corresponding index file is in the same directory will fix the problem. Related issue: the BAM file and the BAM file index mismatch due to capitalization differences in the filenames. For example, your BAM file is <tt class="docutils literal"><span class="pre">reads.bam</span></tt>, but the index is <tt class="docutils literal"><span class="pre">reads.BAM.BAI</span></tt> (note capitalization differences in extension). This will prevent MISO from pairing the index with the BAM file. The index for <tt class="docutils literal"><span class="pre">reads.bam</span></tt> must be instead named <tt class="docutils literal"><span class="pre">reads.bam.bai</span></tt></li>
<li>The chromosome headers of the input BAM file and of your indexed annotation mismatch (e.g. annotation uses UCSC <tt class="docutils literal"><span class="pre">chr</span></tt> style headers, while BAM file uses Ensembl chromosome headers.)</li>
<li>MISO was passed the wrong read length: for example, the reads in your BAM file are of length 50 but you passed a different read length in the <tt class="docutils literal"><span class="pre">--read-len</span></tt> argument. MISO requires the correct read length to be passed.</li>
</ul>
</div></blockquote>
<p>The ultimate way to test if your BAM file can be accessed by MISO is to pick a region from the GFF annotation that you&#8217;re passing to MISO that you know should contain some reads, e.g. <tt class="docutils literal"><span class="pre">chr1:100-300</span></tt> and try to access this via <tt class="docutils literal"><span class="pre">samtools</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>samtools view reads.bam chr1:100-300
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">samtools</span></tt> cannot access the reads in that region, MISO will not be able to either. Failure to access reads in the region is typically caused by one of the above issues. (<a class="reference external" href="#faq">back</a>)</p>
<ol class="arabic simple" id="answer5" start="5">
<li><strong>When I run MISO on my BAM file, it finds far too few reads aligning to the events (but not 0)!</strong> This is typically caused by passing MISO the wrong <tt class="docutils literal"><span class="pre">--read-len</span></tt> arguments, or by passing MISO files that contain a mix of different length reads. Currently MISO does not support mixed read lengths, though implementation of this feature is in the works. If you pass the argument <tt class="docutils literal"><span class="pre">--read-len</span> <span class="pre">50</span></tt> but the actual reads are of length 52, these reads will not be alignable, and so it is important to check the value of this argument. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer6" start="6">
<li><strong>I am making my own GFF annotation file of alternative events for use with MISO. How should I format the</strong> <tt class="docutils literal"><span class="pre">ID</span></tt> <strong>value of GFF entries?</strong> The GFF <tt class="docutils literal"><span class="pre">ID</span></tt> values do not have to have any particular format and are ignored by MISO. These values are only used to link each entry with its parents/children as usual for the GFF format. As long as the chosen <tt class="docutils literal"><span class="pre">ID</span></tt> values maintain the correct relationship between <tt class="docutils literal"><span class="pre">gene</span></tt>, <tt class="docutils literal"><span class="pre">mRNA</span></tt> and <tt class="docutils literal"><span class="pre">exon</span></tt> entries, they can be of any value. MISO will only use the actual genomic coordinates of each entry when processing the annotation. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer7" start="7">
<li><strong>Are there different MISO versions? Which should I use?</strong> The original version of MISO was written in Python, and is no longer supported. The newer of MISO uses a statistical inference engine written in C &#8211; called <tt class="docutils literal"><span class="pre">fastmiso</span></tt> &#8211; that is accessible through a Python interface. Version <tt class="docutils literal"><span class="pre">fastmiso</span></tt> is roughly 60-100x faster than the Python-only version. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer8" start="8">
<li><strong>Where can I download MISO?</strong> MISO can be downloaded from the <a class="reference internal" href="#releases"><em>Releases</em></a> section (to obtain a stable release), or from our GitHub <a class="reference external" href="https://github.com/yarden/MISO">repository</a> where you can get the latest version. See <a class="reference internal" href="#installation"><em>Installation</em></a> section for more information. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer9" start="9">
<li><strong>How can I map MISO alternative event annotations to the genes they are in?</strong> An easy way to do this is to get the transcription start and end sites for all genes, and overlap these with the MISO alternative event coordinates. We provide our own mapping (based on Ensembl gene models) of alternative events to Ensembl gene IDs for the human and mouse annotations, available here <a class="reference internal" href="#events-to-genes"><em>Mapping of alternative events to genes</em></a>. To create your own mapping of events to genes based on a different annotation, all that is needed is a table containing the transcription start/end sites for all genes. These can be be downloaded from the <a class="reference external" href="http://genome.ucsc.edu/">UCSC Genome Browser</a> (by clicking the &#8220;Tables&#8221; tab), or from Ensembl&#8217;s <a class="reference external" href="http://www.ensembl.org/biomart/martview">BioMart</a>. In UCSC tables, the transcription start/end sites are encoded in the fields <tt class="docutils literal"><span class="pre">txStart</span></tt> or <tt class="docutils literal"><span class="pre">txEnd</span></tt>. You can overlap the coordinates of the events given in our GFF3 fields to these start and end sites in your favorite gene model annotation (e.g. UCSC, Ensembl, or Refseq) and determine what gene they overlap.</li>
</ol>
<ol class="arabic simple" id="answer10" start="10">
<li><strong>Can I use MISO with my own custom annotations of alternative events? Or my own annotation of genes from their mRNA isoforms that I obtained from Ensembl/UCSC/Refseq?</strong> Yes. MISO will take any correctly formatted GFF3 file and quantitate the abundances of the mRNAs listed for each entry in that file. Those entries can represent individual alternative splicing events like our own annotation (yielding an &#8220;exon-centric&#8221; quantitation, as described in the documentation), or they might be the full mRNAs of each gene, as described in a database like Ensembl or UCSC (to perform &#8220;isoform-centric&#8221; quantitation). (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer11" start="11">
<li><strong>What is the input to the</strong> <tt class="docutils literal"><span class="pre">--compare-samples</span></tt> <strong>option? Do I have to generate a summary file before using it?</strong> The input to <tt class="docutils literal"><span class="pre">--compare-samples</span></tt> are two directories (corresponding to the two samples to be compared) that are outputted by a call to <tt class="docutils literal"><span class="pre">--run</span></tt> (in <tt class="docutils literal"><span class="pre">miso</span></tt>). There is no need to generate a summary file before calling <tt class="docutils literal"><span class="pre">--compare-samples</span></tt>, and the output of <tt class="docutils literal"><span class="pre">--summarize-samples</span></tt> is not used at all when doing a samples comparison. A summary file is just a single-file summary of the information contained in the directory produced by <tt class="docutils literal"><span class="pre">--run</span></tt> for a particular sample, made for convenience as a summary of the expression levels of exons/isoforms in that sample. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer12" start="12">
<li><strong>I ran MISO on genes/events that have 2 isoforms, but the output summary files and comparison files contain just a single number for</strong> Ψ <strong>for each entry. Shouldn&#8217;t there be 2 numbers, one for each isoform?</strong> If a gene/event has two isoforms, MISO will quantitate the expression level of the first in the annotation (defined as Ψ), which means that the expression level of the other is simply 1 - Ψ. MISO will always report a comma-separated list of isoforms (listed according to their <tt class="docutils literal"><span class="pre">ID=</span></tt> as given in the input annotation file) in the summary and comparison files for each entry that corresponds to the order of the Ψ values, such that there is no ambiguity about which isoform has the expression level Ψ and which is 1 - Ψ. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer13" start="13">
<li><strong>How does MISO deal with replicates?</strong> There are several ways to deal with alternative splicing expression estimates in replicates, but these are not directly in MISO &#8211; currently, MISO does not handle replicates / groups of samples in any special way.  One approach to replicates is to process the BAM file for each replicate separately and then also run MISO on a pooled version of the replicates (e.g. all the experimental samples and all the controls.) This approach allows you to filter events that change by requiring them to change in the same direction (and additionally with similar orders of magnitude) in all the replicates, or most of the replicates.  The Ψ values for all samples can then be clustered (see Wang et. al. (2008) for example) to determine if the exon/isoform expression level for the replicates in the same condition are more similar to each other than to replicates in different condition. If you find that the biological replicates behave similarly based on a clustering analysis, then it might be possible to use MISO estimates for the pooled samples in downstream analyses, where you&#8217;ll have increased power to detect differences. We find that analysis of the replicates independently first works well, since it can weed out events that show a change in only a minority of the biological replicates if you want to be conservative, but also give you power to be inclusive when needed by analyzing the pooled replicates. It is also possible to frame the replicates problem in a traditional statistical framework: if you have a table of read counts supporting each isoform for an event (this is outputted by MISO &#8211; see <a class="reference internal" href="#usingcounts"><em>Using the read class counts</em></a>) for each replicate in your groups, and then you can see if there are group-wide differences in these counts.  This approach is less direct, but should enable detection of group-wide trends &#8211; in an &#8220;ANOVA-like&#8221; way &#8211; by using established statistical techniques for problems that can be framed as a table of counts across different conditions. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer14" start="14">
<li><strong>Is there a mapping from events to genes for hg19?</strong> Yes, there is a mapping based on Ensembl, see <a class="reference internal" href="#events-to-genes"><em>Mapping of alternative events to genes</em></a>. To generate your own mapping, see <a class="reference external" href="#answer9">Question 9</a> of FAQ. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer15" start="15">
<li><strong>If I am running MISO with a GFF annotation containing multiple isoforms, how do I know which isoform each |Psi| value in the vector corresponds to?</strong> (<a class="reference external" href="#answer14">answer</a>) If given a GFF annotation with multiple (i.e. more than 2) mRNA isoforms, MISO will assign Ψ values to isoforms in the order in which their <tt class="docutils literal"><span class="pre">mRNA</span></tt> entries appear in the GFF file. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer16" start="16">
<li><strong>When using</strong> <tt class="docutils literal"><span class="pre">pe_utils</span></tt> <strong>to compute the paired-end insert length distribution, I get the error</strong> <tt class="docutils literal"><span class="pre">[main_samview]</span> <span class="pre">truncated</span> <span class="pre">file</span></tt> <strong>and/or a segmentation fault.</strong> This is usually caused because no reads in your BAM file match the GFF file of constitutive exons given as argument to <tt class="docutils literal"><span class="pre">pe_utils</span></tt>, resulting in an empty BAM file that causes downstream steps to fail. The reason is typically a technical mismatch between the BAM and GFF, like different chromosome naming conventions (e.g. <tt class="docutils literal"><span class="pre">chr</span></tt> prefix chromosome names in the BAM but not in the constitutive exons GFF). See <a class="reference internal" href="#iso-centric"><em>Human/mouse gene models for isoform-centric analyses</em></a> for more information.  (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer17" start="17">
<li><strong>When I try to index GFF files using</strong> <tt class="docutils literal"><span class="pre">index_gff</span></tt> <strong>I get a segmentation fault.</strong> The indexing step requires the <tt class="docutils literal"><span class="pre">shelve</span></tt> module from Python. On some systems and versions of Python, the <tt class="docutils literal"><span class="pre">shelve</span></tt> module can cause a segmentation fault. This is likely a Python installation problem that should be resolved locally. Any Python script that makes use of the <tt class="docutils literal"><span class="pre">shelve.open</span></tt> function will be affected. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer18" start="18">
<li><strong>I am having trouble installing scipy/numpy/matplotlib. How can I install them?</strong> The best way to install Python modules is using a package manager such as <a class="reference external" href="http://packages.python.org/distribute/">distribute</a> <tt class="docutils literal"><span class="pre">easy_install</span></tt> or <a class="reference external" href="http://pypi.python.org/pypi/pip">pip</a>. These package managers automatically detect all the dependencies required for a package (like MISO) and then download and install these dependencies for you. However, Scipy can still be challenging to compile and install because of its various Fortran library dependencies. Another alternative is to get a prepackaged version of all the relevant scientific computing Python modules, such as that offered by <a class="reference external" href="http://www.enthought.com/products/epd.php">Enthought Python Distribution</a> (EPD), which is free for academic use and supported on Linux, Mac and Windows. Mac users might also be interested in the <a class="reference external" href="http://fonnesbeck.github.com/ScipySuperpack/">Superpack</a> installation script which automatically these scientific computing Python modules and others. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer19" start="19">
<li><strong>When should I use paired-end mode versus single-end mode?</strong> Paired-end inference should be used when possible, with one important exception. MISO only uses properly paired reads within an annotated event. If the GFF annotation you use contains events that are roughly as long or shorter than your insert length, then simply due to the length constraint, there won&#8217;t be many read pairs in your data where both ends are mapped within the annotated event. In this case, it&#8217;s best to use single-end reads. Failure to use single-end mode in this case can result in many events appearing not to have enough coverage, because no paired mates contained entirely within the event can be found, in spite of there being many read pairs where one of the mates maps within the event and is informative about the isoforms that are being expressed. Also, as of release 0.4.8, single-end inference is dramatically faster (particularly for high-coverage datasets) than paired-end inference. (<a class="reference external" href="#faq">back</a>)</li>
</ol>
<ol class="arabic simple" id="answer20" start="20">
<li><strong>What is the license for MISO?</strong> As of July 2014, MISO is now the &lt;a href=&#8221;<a class="reference external" href="http://en.wikipedia.org/wiki/BSD_licenses">http://en.wikipedia.org/wiki/BSD_licenses</a>&#8220;&gt;MIT/BSD license&lt;/a&gt;.</li>
</ol>
</div>
</div>
<div class="section" id="advanced-uses-of-miso">
<h1>Advanced uses of MISO<a class="headerlink" href="#advanced-uses-of-miso" title="Permalink to this headline">¶</a></h1>
<p>Rather than estimating the expression level of a single alternatively spliced exon (&#8220;exon-centric&#8221;),
or of each transcript belonging to a gene (&#8220;isoform-centric&#8221;), one can quantify the levels of multiple
isoforms produced by several nearby alternative splicing events. This is called
<em>local multi-isoform quantitation</em>. These isoforms can be encoded in the GFF format as for the
case of alternative splicing events that produce two isoforms, described in <a class="reference internal" href="#gff-event-annotation"><em>GFF-based alternative events format</em></a>.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Section under construction</p>
</div>
</div></blockquote>
</div>
<div class="section" id="acknowledgements">
<span id="katz"></span><span id="refs"></span><h1>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h1>
<p>Thanks to the following users for their feedback/comments on MISO and
for suggesting many improvements, or for creating useful software used by MISO:</p>
<ul class="simple">
<li>Sol Katzman (UCSC)</li>
<li>Brenton Graveley (UConn)</li>
<li>Michael Lovci (UCSD)</li>
<li>Marvin Jens (Max-Delbrueck-Center for Molecular Medicine)</li>
<li>Schragi Schwartz (Broad Institute)</li>
<li>Rahul Satija (Broad Institute)</li>
<li>Henry Bigelow (Broad Institute)</li>
<li>Ersen Kavak (Karolinska Institute)</li>
<li>Essi Laajala (University of Turku)</li>
<li>Kuan-Ting Lin (CSHL)</li>
<li>Aaron Quinlan (University of Virginia)</li>
<li>Ross Lazarus (Harvard Medical School)</li>
<li>Isaac Berkowitz (Brown University)</li>
<li>Chia-Ho Lin (UCLA)</li>
<li>Shaun Mahony (MIT)</li>
<li>Albert W. Cheng (MIT)</li>
<li>Rory Kirchner (MIT)</li>
<li>Robert K. Bradley (MIT)</li>
<li>Brad Friedman (MIT)</li>
<li>Vincent Butty (MIT)</li>
<li>Jessica Hurt (MIT)</li>
<li>Reut Shalgi (MIT)</li>
<li>Colin Dewey (University of Wisconsin-Madison)</li>
<li>Eric Suh (Princeton)</li>
<li>Warren Emmett (UCL)</li>
<li>Maayan Kreitzman (BCGSC)</li>
<li>John Tobias (UPenn)</li>
<li>Sabine Dietmann (MRC, University of Cambridge)</li>
</ul>
</div>
<div class="section" id="authors">
<h1>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>The original Python version of MISO was written by Yarden Katz. The C version of MISO was written by Gábor Csárdi, with Python interfaces written by Yarden Katz and an R interface written by Gábor Csárdi. Parts of the code for visualizing MISO estimates was written by Eric T. Wang. The MISO manual was written by Yarden Katz.</li>
</ul>
</div>
<div class="section" id="installing-python-only-miso-version">
<span id="installing-pymiso"></span><h1>Installing Python-only MISO version<a class="headerlink" href="#installing-python-only-miso-version" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The Python-only version of MISO is now deprecated &#8211; we recommend using <tt class="docutils literal"><span class="pre">fastmiso</span></tt>.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="references">
<span id="myrefs"></span><h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li>Katz Y, Wang ET, Airoldi EM, Burge CB. (2010). <a class="reference external" href="http://www.nature.com/nmeth/journal/v7/n12/full/nmeth.1528.html">Analysis and design of RNA sequencing experiments for identifying isoform regulation</a>. Nature Methods 7, 1009-1015.</li>
<li>Wang ET, Sandberg R, Luo S, Khrebtukova I, Zhang L, Mayr C, Kingsmore SF, Schroth GP, Burge CB. (2008). Alternative Isoform Regulation in Human Tissue Transcriptomes. Nature 456, 470-476</li>
</ol>
<div class="section" id="related-software">
<h2>Related software<a class="headerlink" href="#related-software" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="sashimi.html">sashimi_plot</a>: tool for visualizing RNA-Seq data and plotting MISO output</li>
<li><a class="reference external" href="http://bowtie-bio.sourceforge.net/">Bowtie</a>: for alignment of RNA-Seq reads to genome (optionally with precomputed set of splice junctions)</li>
<li><a class="reference external" href="http://tophat.cbcb.umd.edu/">Tophat</a>: for spliced alignment of RNA-Seq reads to genome with <em>de
novo</em> splice junction discovery</li>
<li><a class="reference external" href="http://www.broadinstitute.org/igv/">IGV</a>: Visualizer of mapped reads (e.g. BAM files). Displays junction reads.</li>
<li><a class="reference external" href="http://cufflinks.cbcb.umd.edu/">Cufflinks</a>: another isoform expression/differential regulation software with transcript assembly</li>
</ul>
</div>
<div class="section" id="related-reading">
<h2>Related reading<a class="headerlink" href="#related-reading" title="Permalink to this headline">¶</a></h2>
<div class="section" id="probabilistic-models-in-computational-biology">
<h3>Probabilistic models in computational biology<a class="headerlink" href="#probabilistic-models-in-computational-biology" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Airoldi, E.M. (2007). <a class="reference external" href="http://dx.doi.org/10.1371/journal.pcbi.0030252">Getting started in probabilistic graphical models</a>. PLoS Computational Biology, 3, e252.</li>
</ul>
</div>
<div class="section" id="bayes-factors-and-bayesian-hypothesis-testing">
<h3>Bayes factors and Bayesian hypothesis testing<a class="headerlink" href="#bayes-factors-and-bayesian-hypothesis-testing" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://www.socsci.uci.edu/~mdlee/bgm.html">A Practical Course in Bayesian Graphical Modeling</a> by Michael Lee and Eric-Jan Wagenmakers: Free online book that contains (among many other things) excellent chapters on Bayesian hypothesis testing with practical examples, including discussion of Bayes factors and the Savage-Dickey ratio test.</li>
</ul>
</div>
<div class="section" id="general-reading-on-probabilistic-modeling-and-inference">
<h3>General reading on probabilistic modeling and inference<a class="headerlink" href="#general-reading-on-probabilistic-modeling-and-inference" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Griffiths, T. L., &amp; Yuille, A. (2006). <a class="reference external" href="http://cocosci.berkeley.edu/tom/papers/tutorial.pdf">A primer on probabilistic inference</a>. Trends in Cognitive Sciences, 10.</li>
</ul>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="" class="btn btn-neutral float-right" title="MISO (Mixture of Isoforms) software documentation">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2010, Yarden Katz, Gábor Csárdi, Eric T. Wang, Edoardo M. Airoldi, Christopher B. Burge.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: fastmiso
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/fastmiso/">fastmiso</a></dd>
        
          <dd><a href="/en/dev/">dev</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://readthedocs.org/projects/miso/downloads/pdf/fastmiso/">PDF</a></dd>
        
          <dd><a href="https://readthedocs.org/projects/miso/downloads/htmlzip/fastmiso/">HTML</a></dd>
        
          <dd><a href="https://readthedocs.org/projects/miso/downloads/epub/fastmiso/">Epub</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/miso/?fromdocs=miso">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/miso/?fromdocs=miso">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/underscore.js"></script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/doctools.js"></script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>

  

  
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
